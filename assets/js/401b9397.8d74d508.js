"use strict";(self.webpackChunkdocumentation=self.webpackChunkdocumentation||[]).push([[82294],{58860:(e,n,t)=>{t.d(n,{xA:()=>d,yg:()=>u});var o=t(37953);function a(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function i(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,o)}return t}function r(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?i(Object(t),!0).forEach((function(n){a(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):i(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function l(e,n){if(null==e)return{};var t,o,a=function(e,n){if(null==e)return{};var t,o,a={},i=Object.keys(e);for(o=0;o<i.length;o++)t=i[o],n.indexOf(t)>=0||(a[t]=e[t]);return a}(e,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)t=i[o],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var p=o.createContext({}),s=function(e){var n=o.useContext(p),t=n;return e&&(t="function"==typeof e?e(n):r(r({},n),e)),t},d=function(e){var n=s(e.components);return o.createElement(p.Provider,{value:n},e.children)},m="mdxType",c={inlineCode:"code",wrapper:function(e){var n=e.children;return o.createElement(o.Fragment,{},n)}},g=o.forwardRef((function(e,n){var t=e.components,a=e.mdxType,i=e.originalType,p=e.parentName,d=l(e,["components","mdxType","originalType","parentName"]),m=s(t),g=a,u=m["".concat(p,".").concat(g)]||m[g]||c[g]||i;return t?o.createElement(u,r(r({ref:n},d),{},{components:t})):o.createElement(u,r({ref:n},d))}));function u(e,n){var t=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var i=t.length,r=new Array(i);r[0]=g;var l={};for(var p in n)hasOwnProperty.call(n,p)&&(l[p]=n[p]);l.originalType=e,l[m]="string"==typeof e?e:a,r[1]=l;for(var s=2;s<i;s++)r[s]=t[s];return o.createElement.apply(null,r)}return o.createElement.apply(null,t)}g.displayName="MDXCreateElement"},1532:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>p,default:()=>u,frontMatter:()=>l,metadata:()=>s,toc:()=>m});t(37953);var o=t(58860);function a(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function i(e,n){return n=null!=n?n:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):function(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,o)}return t}(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})),e}function r(e,n){if(null==e)return{};var t,o,a=function(e,n){if(null==e)return{};var t,o,a={},i=Object.keys(e);for(o=0;o<i.length;o++)t=i[o],n.indexOf(t)>=0||(a[t]=e[t]);return a}(e,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)t=i[o],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}const l={title:"Adding CRUD Pages",description:"We'll be adding CRUD pages for Company, Client and Contact resources in this post.",slug:"refine-react-invoice-generator-3",authors:"abdullah_numan",tags:["refine-week","refine","strapi","ant-design"],image:"https://refine.ams3.cdn.digitaloceanspaces.com/blog/2023-04-12-refine-invoicer-3/social.png",hide_table_of_contents:!1},p=void 0,s={permalink:"/blog/refine-react-invoice-generator-3",source:"@site/blog/2023-04-12-refine-invoicer-3.md",title:"Adding CRUD Pages",description:"We'll be adding CRUD pages for Company, Client and Contact resources in this post.",date:"2023-04-12T00:00:00.000Z",formattedDate:"April 12, 2023",tags:[{label:"refine-week",permalink:"/blog/tags/refine-week"},{label:"refine",permalink:"/blog/tags/refine"},{label:"strapi",permalink:"/blog/tags/strapi"},{label:"ant-design",permalink:"/blog/tags/ant-design"}],readingTime:26.895,hasTruncateMarker:!1,authors:[{name:"Abdullah Numan",title:"Fullstack Developer",url:"https://github.com/anewman15/",imageURL:"https://github.com/anewman15.png",key:"abdullah_numan"}],frontMatter:{title:"Adding CRUD Pages",description:"We'll be adding CRUD pages for Company, Client and Contact resources in this post.",slug:"refine-react-invoice-generator-3",authors:"abdullah_numan",tags:["refine-week","refine","strapi","ant-design"],image:"https://refine.ams3.cdn.digitaloceanspaces.com/blog/2023-04-12-refine-invoicer-3/social.png",hide_table_of_contents:!1},prevItem:{title:"Creating Mission and Invoice Pages",permalink:"/blog/refine-react-invoice-generator-4"},nextItem:{title:"Setting Up the Invoicer App",permalink:"/blog/refine-react-invoice-generator-2"},relatedPosts:[{title:"Building a React Admin Panel with Refine and daisyUI",description:"We'll build a simple React admin panel using Refine and daisyUI.",permalink:"/blog/daisy-ui-react-admin-panel",formattedDate:"September 6, 2023",authors:[{name:"Abdullah Numan",title:"Fullstack Developer",url:"https://github.com/anewman15/",imageURL:"https://github.com/anewman15.png",key:"abdullah_numan"}],readingTime:60.515,date:"2023-09-06T00:00:00.000Z"},{title:"Adding CRUD Actions and Authentication",description:"We'll initialize our Pixels app using Refine and get familiar with the boilerplate code to be created with the create refine-app CLI tool.",permalink:"/blog/refine-pixels-3",formattedDate:"February 16, 2023",authors:[{name:"Abdullah Numan",title:"Fullstack Developer",url:"https://github.com/anewman15/",imageURL:"https://github.com/anewman15.png",key:"abdullah_numan"}],readingTime:29.96,date:"2023-02-16T00:00:00.000Z"},{title:"Pilot & Refine architecture",description:"We'll be taking a look at the architecture of Refine and how week of RefineWeek series will be structured.",permalink:"/blog/refine-react-invoice-generator-1",formattedDate:"April 10, 2023",authors:[{name:"Abdullah Numan",title:"Fullstack Developer",url:"https://github.com/anewman15/",imageURL:"https://github.com/anewman15.png",key:"abdullah_numan"}],readingTime:9.195,date:"2023-04-10T00:00:00.000Z"}],authorPosts:[{title:"A Quick Introduction to Meta's Stylex",description:"This post quickly explores how to apply statically typed, atomic CSS styles to React components with Stylex APIs in a Next.js application.",permalink:"/blog/meta-stylex",formattedDate:"September 16, 2024",authors:[{name:"Abdullah Numan",title:"Fullstack Developer",url:"https://github.com/anewman15/",imageURL:"https://github.com/anewman15.png",key:"abdullah_numan"}],readingTime:16.035,date:"2024-09-16T00:00:00.000Z"},{title:"Adding Realtime Collaboration",description:"We'll implement realtime broadcast and subscription of pixels updates in Pixels app.",permalink:"/blog/refine-pixels-4",formattedDate:"February 17, 2023",authors:[{name:"Abdullah Numan",title:"Fullstack Developer",url:"https://github.com/anewman15/",imageURL:"https://github.com/anewman15.png",key:"abdullah_numan"}],readingTime:10.17,date:"2023-02-17T00:00:00.000Z"},{title:"Adding CRUD Actions and Authentication",description:"We'll initialize our Pixels app using Refine and get familiar with the boilerplate code to be created with the create refine-app CLI tool.",permalink:"/blog/refine-pixels-3",formattedDate:"February 16, 2023",authors:[{name:"Abdullah Numan",title:"Fullstack Developer",url:"https://github.com/anewman15/",imageURL:"https://github.com/anewman15.png",key:"abdullah_numan"}],readingTime:29.96,date:"2023-02-16T00:00:00.000Z"}]},d={authorsImageUrls:[void 0]},m=[{value:"RefineWeek ft. Strapi series",id:"refineweek-ft-strapi-series",level:3},{value:"Overview",id:"overview",level:2},{value:"Version 4 Housekeeping",id:"version-4-housekeeping",level:2},{value:"Cleanup",id:"cleanup",level:3},{value:"Strapi API Tokens",id:"strapi-api-tokens",level:3},{value:"Type Definitions",id:"type-definitions",level:3},{value:"Implementing CRUD Operations",id:"implementing-crud-operations",level:2},{value:"Adding <code>resources</code> to <code>&lt;Refine /&gt;</code>",id:"adding-resources-to-refine-",level:3},{value:"Adding Routes to <code>&lt;Refine /&gt;</code>",id:"adding-routes-to-refine-",level:3},{value:"Page Views in Refine",id:"page-views-in-refine",level:2},{value:"Adding Views for Companies",id:"adding-views-for-companies",level:2},{value:"<code>list</code> View for <code>companies</code>",id:"list-view-for-companies",level:3},{value:"Company <code>create</code> Action",id:"company-create-action",level:3},{value:"Company <code>edit</code> and <code>delete</code> Actions",id:"company-edit-and-delete-actions",level:3},{value:"Email Authentication with Strapi in Refine",id:"email-authentication-with-strapi-in-refine",level:3},{value:"refine-Ant Design <code>&lt;AuthPage /</code> Component",id:"refine-ant-design-authpage--component",level:3},{value:"Adding Views for <code>clients</code>",id:"adding-views-for-clients",level:2},{value:"<code>list</code> View for <code>clients</code>",id:"list-view-for-clients",level:3},{value:"<code>create</code> and <code>edit</code> Actions for <code>clients</code>",id:"create-and-edit-actions-for-clients",level:3},{value:"<code>delete</code> Action for <code>clients</code>",id:"delete-action-for-clients",level:3},{value:"Adding Views for <code>contacts</code>",id:"adding-views-for-contacts",level:2},{value:"<code>list</code> View for <code>contacts</code>",id:"list-view-for-contacts",level:3},{value:"<code>create</code> Action for <code>contacts</code>",id:"create-action-for-contacts",level:3},{value:"<code>edit</code> Action for <code>contacts</code>",id:"edit-action-for-contacts",level:3},{value:"<code>delete</code> Action for <code>contacts</code>",id:"delete-action-for-contacts",level:3},{value:"Summary",id:"summary",level:2}],c={toc:m},g="wrapper";function u(e){var{components:n}=e,t=r(e,["components"]);return(0,o.yg)(g,i(function(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},o=Object.keys(t);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),o.forEach((function(n){a(e,n,t[n])}))}return e}({},c,t),{components:n,mdxType:"MDXLayout"}),(0,o.yg)("p",null,"In this post, we build on our existing understanding of ",(0,o.yg)("inlineCode",{parentName:"p"},"dataProvider")," and ",(0,o.yg)("inlineCode",{parentName:"p"},"authProvider")," props of ",(0,o.yg)("inlineCode",{parentName:"p"},"<Refine />")," to implement CRUD operations in our ",(0,o.yg)("strong",{parentName:"p"},"Pdf Invoice Generator")," app that we initialized in the previous post. While doing so, we discuss the roles of ",(0,o.yg)("inlineCode",{parentName:"p"},"<Refine />")," component's ",(0,o.yg)("inlineCode",{parentName:"p"},"resources")," and routing conventions as well."),(0,o.yg)("p",null,"CRUD actions are supported by the ",(0,o.yg)("a",{parentName:"p",href:"https://strapi.io/"},(0,o.yg)("strong",{parentName:"a"},"Strapi"))," data provider we chose for our project and in this post we use them to build pages for ",(0,o.yg)("strong",{parentName:"p"},"Company"),", ",(0,o.yg)("strong",{parentName:"p"},"Client")," and ",(0,o.yg)("strong",{parentName:"p"},"Contact")," resources. We implement appropriate pages and partial components with ",(0,o.yg)("inlineCode",{parentName:"p"},"list"),", ",(0,o.yg)("inlineCode",{parentName:"p"},"create"),", ",(0,o.yg)("inlineCode",{parentName:"p"},"edit")," and ",(0,o.yg)("inlineCode",{parentName:"p"},"delete")," actions. We also add auth features we discussed on Day Two of the ",(0,o.yg)("a",{parentName:"p",href:"https://refine.dev/week-of-refine-strapi/"},(0,o.yg)("strong",{parentName:"a"},"RefineWeek"))," series."),(0,o.yg)("p",null,"We're on Day Three and this ",(0,o.yg)("strong",{parentName:"p"},"RefineWeek")," is a five-part tutorial that aims to help developers learn the ins-and-outs of ",(0,o.yg)("strong",{parentName:"p"},"Refine"),"'s powerful capabilities and get going with ",(0,o.yg)("strong",{parentName:"p"},"Refine")," within a week."),(0,o.yg)("h3",{id:"refineweek-ft-strapi-series"},"RefineWeek ft. Strapi series"),(0,o.yg)("ul",null,(0,o.yg)("li",{parentName:"ul"},"Day 1 - ",(0,o.yg)("a",{parentName:"li",href:"https://refine.dev/blog/refine-react-invoice-generator-1/"},"Pilot & Refine architecture")),(0,o.yg)("li",{parentName:"ul"},"Day 2 - ",(0,o.yg)("a",{parentName:"li",href:"https://refine.dev/blog/refine-react-invoice-generator-2/"},"Setting Up the Invoicer App"))),(0,o.yg)("h2",{id:"overview"},"Overview"),(0,o.yg)("p",null,"In the last episode, we explored ",(0,o.yg)("strong",{parentName:"p"},"Refine"),"'s auth and data providers in significant details. We saw that ",(0,o.yg)("inlineCode",{parentName:"p"},"<Refine />"),"'s ",(0,o.yg)("inlineCode",{parentName:"p"},"dataProvider")," and ",(0,o.yg)("inlineCode",{parentName:"p"},"authProvider")," props were set to support ",(0,o.yg)("strong",{parentName:"p"},"Strapi")," thanks to the ",(0,o.yg)("a",{parentName:"p",href:"https://github.com/refinedev/refine/tree/main/packages/strapi"},(0,o.yg)("inlineCode",{parentName:"a"},"@refinedev/strapi-v4"))," package."),(0,o.yg)("p",null,"We mentioned that ",(0,o.yg)("inlineCode",{parentName:"p"},"dataProvider")," methods allow us to communicate with API endpoints and ",(0,o.yg)("inlineCode",{parentName:"p"},"authProvider")," methods help us with authentication and authorization. We are able to access and invoke these methods from consumer components via their corresponding hooks."),(0,o.yg)("p",null,"In this post, we leverage the ",(0,o.yg)("strong",{parentName:"p"},"Strapi")," ",(0,o.yg)("inlineCode",{parentName:"p"},"dataProvider")," methods to implement CRUD operations for ",(0,o.yg)("inlineCode",{parentName:"p"},"companies"),", ",(0,o.yg)("inlineCode",{parentName:"p"},"clients")," and ",(0,o.yg)("inlineCode",{parentName:"p"},"contacts")," resources. We start by passing them to the ",(0,o.yg)("inlineCode",{parentName:"p"},"resources")," prop on ",(0,o.yg)("inlineCode",{parentName:"p"},"<Refine />")," and we aim to be able to perform ",(0,o.yg)("inlineCode",{parentName:"p"},"list"),", ",(0,o.yg)("inlineCode",{parentName:"p"},"create"),", ",(0,o.yg)("inlineCode",{parentName:"p"},"show"),", ",(0,o.yg)("inlineCode",{parentName:"p"},"edit")," and ",(0,o.yg)("inlineCode",{parentName:"p"},"delette")," actions where appropriate."),(0,o.yg)("p",null,"We will make use of the ",(0,o.yg)("strong",{parentName:"p"},"Strapi")," auth provider and the ",(0,o.yg)("inlineCode",{parentName:"p"},"<AuthPage />")," component, both of which comes baked with the boilerplate code as we chose to include example pages when we initialized the project. On the way, we will explore a series of convenient ",(0,o.yg)("strong",{parentName:"p"},"Refine")," hooks and components which making CRUD operations implementation a breeze. In particular, we'll focus on ",(0,o.yg)("inlineCode",{parentName:"p"},"useSimpleList()"),", ",(0,o.yg)("inlineCode",{parentName:"p"},"useModalForm()"),", ",(0,o.yg)("inlineCode",{parentName:"p"},"useDrawerForm"),", ",(0,o.yg)("inlineCode",{parentName:"p"},"useTable()")," and ",(0,o.yg)("inlineCode",{parentName:"p"},"useFrom()"),". And components such as ",(0,o.yg)("strong",{parentName:"p"},"Ant Design")," ",(0,o.yg)("inlineCode",{parentName:"p"},"<List />")," imported as ",(0,o.yg)("inlineCode",{parentName:"p"},"<AntdList />"),", ",(0,o.yg)("inlineCode",{parentName:"p"},"<Modal />"),", ",(0,o.yg)("inlineCode",{parentName:"p"},"<Drawer />")," and ",(0,o.yg)("strong",{parentName:"p"},"refine-Ant Design"),"'s ",(0,o.yg)("inlineCode",{parentName:"p"},"<List />")," and ",(0,o.yg)("inlineCode",{parentName:"p"},"<Authpage />")," components."),(0,o.yg)("br",null),(0,o.yg)("h2",{id:"version-4-housekeeping"},"Version 4 Housekeeping"),(0,o.yg)("p",null,"Before we start adding our resources, we need to remove the code related to ",(0,o.yg)("inlineCode",{parentName:"p"},"products")," and ",(0,o.yg)("inlineCode",{parentName:"p"},"categories")," resources and then set up access tokens for ",(0,o.yg)("strong",{parentName:"p"},"Strapi"),"."),(0,o.yg)("h3",{id:"cleanup"},"Cleanup"),(0,o.yg)("p",null,"So, let's cleanslate the ",(0,o.yg)("inlineCode",{parentName:"p"},"resources")," prop and remove the imports and routes for ",(0,o.yg)("inlineCode",{parentName:"p"},"products")," and ",(0,o.yg)("inlineCode",{parentName:"p"},"categories"),"."),(0,o.yg)("p",null,"We'll have to change the name of our app to ",(0,o.yg)("strong",{parentName:"p"},"Invoicer"),". So, let's replace all instances of ",(0,o.yg)("strong",{parentName:"p"},"Refine Project")," to ",(0,o.yg)("strong",{parentName:"p"},"Invoicer"),"."),(0,o.yg)("p",null,"After cleaning up, the ",(0,o.yg)("inlineCode",{parentName:"p"},"<App />")," component should look as below:"),(0,o.yg)("details",null,(0,o.yg)("summary",null,"Show App.tsx code"),(0,o.yg)("p",null,(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-tsx",metastring:'title="App.tsx"',title:'"App.tsx"'},'import { Authenticated, GitHubBanner, Refine } from "@refinedev/core";\nimport { RefineKbar, RefineKbarProvider } from "@refinedev/kbar";\n\nimport {\n  AuthPage,\n  ErrorComponent,\n  ThemedLayout,\n  useNotificationProvider,\n  ThemedTitle,\n} from "@refinedev/antd";\nimport "@refinedev/antd/dist/reset.css";\nimport * as Icons from "@ant-design/icons";\n\nconst { UserAddOutlined, TeamOutlined, InfoCircleOutlined } = Icons;\n\nimport routerBindings, {\n  CatchAllNavigate,\n  NavigateToResource,\n  UnsavedChangesNotifier,\n} from "@refinedev/react-router";\nimport { DataProvider } from "@refinedev/strapi-v4";\nimport { BrowserRouter, Outlet, Route, Routes } from "react-router-dom";\nimport { authProvider, axiosInstance } from "./authProvider";\nimport { Header } from "./components/header";\nimport { API_URL } from "./constants";\nimport { ColorModeContextProvider } from "./contexts/color-mode";\n\nfunction App() {\n  return (\n    <BrowserRouter>\n      <GitHubBanner />\n      <RefineKbarProvider>\n        <ColorModeContextProvider>\n          <Refine\n            resources={\n              [\n                // resources removed\n              ]\n            }\n            authProvider={authProvider}\n            dataProvider={DataProvider(API_URL + `/api`, axiosInstance)}\n            notificationProvider={useNotificationProvider}\n            routerProvider={routerBindings}\n            options={{\n              syncWithLocation: true,\n              warnWhenUnsavedChanges: true,\n            }}\n          >\n            <Routes>\n              <Route\n                element={\n                  <Authenticated fallback={<CatchAllNavigate to="/login" />}>\n                    <ThemedLayout\n                      Header={Header}\n                      Title={({ collapsed }) => (\n                        <ThemedTitleV2 collapsed={collapsed} text="Invoicer" />\n                      )}\n                    >\n                      <Outlet />\n                    </ThemedLayout>\n                  </Authenticated>\n                }\n              >\n                // routes removed\n              </Route>\n              <Route\n                element={\n                  <Authenticated fallback={<Outlet />}>\n                    <NavigateToResource />\n                  </Authenticated>\n                }\n              >\n                <Route\n                  path="/login"\n                  element={\n                    <AuthPage\n                      type="login"\n                      title={<ThemedTitleV2 collapsed text="Invoicer" />}\n                      formProps={{\n                        initialValues: {\n                          email: "demo@refine.dev",\n                          password: "demodemo",\n                        },\n                      }}\n                    />\n                  }\n                />\n              </Route>\n              <Route\n                element={\n                  <Authenticated>\n                    <ThemedLayout\n                      Header={Header}\n                      Title={({ collapsed }) => (\n                        <ThemedTitleV2 collapsed={collapsed} text="Invoicer" />\n                      )}\n                    >\n                      <Outlet />\n                    </ThemedLayout>\n                  </Authenticated>\n                }\n              >\n                <Route path="*" element={<ErrorComponent />} />\n              </Route>\n            </Routes>\n\n            <RefineKbar />\n            <UnsavedChangesNotifier />\n          </Refine>\n        </ColorModeContextProvider>\n      </RefineKbarProvider>\n    </BrowserRouter>\n  );\n}\n\nexport default App;\n')))),(0,o.yg)("h3",{id:"strapi-api-tokens"},"Strapi API Tokens"),(0,o.yg)("p",null,"In order for ",(0,o.yg)("inlineCode",{parentName:"p"},"dataProvider")," and ",(0,o.yg)("inlineCode",{parentName:"p"},"authProvider")," to work, we need to create an API token in the ",(0,o.yg)("strong",{parentName:"p"},"Strapi")," backend so that we can use it to access the API endpoints from our ",(0,o.yg)("strong",{parentName:"p"},"Refine")," ",(0,o.yg)("strong",{parentName:"p"},"Pdf Invoice Generator")," app. We can create it from the ",(0,o.yg)("inlineCode",{parentName:"p"},"Settings >> API Tokens")," page of the dashboard of the ",(0,o.yg)("strong",{parentName:"p"},"Strapi")," backend we are running at ",(0,o.yg)("inlineCode",{parentName:"p"},"http://localhost:1337"),"."),(0,o.yg)("p",null,"Please follow ",(0,o.yg)("a",{parentName:"p",href:"https://docs.strapi.io/user-docs/settings/managing-global-settings#creating-a-new-api-token"},"this section")," of the ",(0,o.yg)("strong",{parentName:"p"},"Strapi")," docs for more details on creating API Tokens."),(0,o.yg)("p",null,"I have created mine. After creating the token, we have to place it inside ",(0,o.yg)("inlineCode",{parentName:"p"},"src/constants.ts")," file. So, let's update it:"),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-tsx",metastring:'title="src/constants.ts"',title:'"src/constants.ts"'},'export const API_URL = "http://localhost:1337";\nexport const TOKEN_KEY =\n  "625b118353b2924b459527cd39f7ca792a870cc13619562a3e3f8ee6908519c581bcabb8152cbd10913e72d9adf725e6bd99b8793632b34d1dd952544e3bd883eaba7c3ab169308cd29730267247147d20af102d70a311d515d9b5ab06384e0a2418fe47ecda895d74d87bbcf6bbc74d9b318d5795fcf7be1691ed4524d73621";\n')),(0,o.yg)("p",null,"With these done, now we are one step closer to start adding resourcess with their associated routes, pages and components. --\x3e"),(0,o.yg)("h3",{id:"type-definitions"},"Type Definitions"),(0,o.yg)("p",null,"We'll use the following type definitions for our entities:"),(0,o.yg)("details",null,(0,o.yg)("summary",null,"Show Interfaces"),(0,o.yg)("p",null,(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-tsx",metastring:'title="src/interfaces/index.d.ts"',title:'"src/interfaces/index.d.ts"'},'export interface ICompany {\n  id: string;\n  name: string;\n  address: string;\n  country: string;\n  city: string;\n  email: string;\n  website: string;\n  logo?: null | { url: string };\n}\n\nexport interface IClient {\n  id: string;\n  name: string;\n  contacts: IContact[];\n}\n\nexport interface IContact {\n  id: string;\n  first_name: string;\n  last_name: string;\n  client: IClient;\n  email: string;\n}\n\nexport interface IMission {\n  id: string;\n  mission: string;\n  day: number;\n  daily_rate: number;\n}\n\nexport interface IInvoice {\n  id: string;\n  name: string;\n  date: Date;\n  company: ICompany;\n  discount: number;\n  tax: number;\n  custom_id: string;\n  comments: string;\n  contact: IContact;\n  missions: IMission[];\n  status: Status;\n}\n\ntype Status = {\n  status: "Paid" | "No Paid";\n};\n')))),(0,o.yg)("h2",{id:"implementing-crud-operations"},"Implementing CRUD Operations"),(0,o.yg)("p",null,(0,o.yg)("inlineCode",{parentName:"p"},"create"),", ",(0,o.yg)("inlineCode",{parentName:"p"},"show"),", ",(0,o.yg)("inlineCode",{parentName:"p"},"edit"),", ",(0,o.yg)("inlineCode",{parentName:"p"},"list"),", and ",(0,o.yg)("inlineCode",{parentName:"p"},"delete")," actions in ",(0,o.yg)("strong",{parentName:"p"},"Refine")," are achieved through the collective interactions of methods from several providers, including ",(0,o.yg)("inlineCode",{parentName:"p"},"dataProvider"),", ",(0,o.yg)("inlineCode",{parentName:"p"},"routerProvider")," and others such as the ",(0,o.yg)("inlineCode",{parentName:"p"},"notificationsProvider")," and the ",(0,o.yg)("inlineCode",{parentName:"p"},"accessControlProvider"),". They primarily rely on the ",(0,o.yg)("inlineCode",{parentName:"p"},"resources")," prop for the resource names and path definitions in order to match incoming requests with the appropriate views."),(0,o.yg)("p",null,"In versions ",(0,o.yg)("inlineCode",{parentName:"p"},"< v4"),", ",(0,o.yg)("inlineCode",{parentName:"p"},"resources")," items used to include view definitions (for example, ",(0,o.yg)("inlineCode",{parentName:"p"},"list: CompanyList"),") such as in the following:"),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-tsx",metastring:'title="version v3 resource object"',title:'"version',v3:!0,resource:!0,'object"':!0},'{\n    name: "companies",\n    meta: { label: "Company" },\n    list: CompanyList,\n    icon: <InfoCircleOutlined />,\n},\n')),(0,o.yg)("p",null,"However, view definitions are not used in ",(0,o.yg)("inlineCode",{parentName:"p"},"v4")," ",(0,o.yg)("inlineCode",{parentName:"p"},"resources")," items. Instead, as we will see below, ",(0,o.yg)("strong",{parentName:"p"},"path definitions")," are specified. Version ",(0,o.yg)("inlineCode",{parentName:"p"},"v4")," allows flexible routing with ",(0,o.yg)("inlineCode",{parentName:"p"},"<Route />")," components, and so view definitions for each ",(0,o.yg)("inlineCode",{parentName:"p"},"resources")," item are now configured inside ",(0,o.yg)("inlineCode",{parentName:"p"},"<Route />")," components."),(0,o.yg)("p",null,"In the mean time, legacy resource definitions, data and auth providers are still functional in ",(0,o.yg)("strong",{parentName:"p"},"Refine")," ",(0,o.yg)("inlineCode",{parentName:"p"},"v4"),". If you want to use the legacy ",(0,o.yg)("inlineCode",{parentName:"p"},"resources")," convention, you have to use the ",(0,o.yg)("inlineCode",{parentName:"p"},"legacyRouterProvider")," prop instead of ",(0,o.yg)("inlineCode",{parentName:"p"},"routerProvider")," and ",(0,o.yg)("inlineCode",{parentName:"p"},"legacyAuthProvider")," prop instead of the ",(0,o.yg)("inlineCode",{parentName:"p"},"authProvider")," prop of the ",(0,o.yg)("inlineCode",{parentName:"p"},"<Refine />")," component. More on this ",(0,o.yg)("a",{parentName:"p",href:"https://refine.dev/docs/api-reference/core/providers/router-provider/#legacy-router-provider"},"here"),"."),(0,o.yg)("p",null,"In this app, we are using the new definitions introduced in ",(0,o.yg)("inlineCode",{parentName:"p"},"v4"),"."),(0,o.yg)("p",null,"Keeping these points in mind, let's now implement CRUD operations for ",(0,o.yg)("inlineCode",{parentName:"p"},"companies"),", ",(0,o.yg)("inlineCode",{parentName:"p"},"clients")," and ",(0,o.yg)("inlineCode",{parentName:"p"},"contacts"),". We'll first add the resource objects and route definitions, at once for all the three resources above. In the later sections, we'll consider the CRUD actions one by one for each resource with related pages and partial components."),(0,o.yg)("h3",{id:"adding-resources-to-refine-"},"Adding ",(0,o.yg)("inlineCode",{parentName:"h3"},"resources")," to ",(0,o.yg)("inlineCode",{parentName:"h3"},"<Refine />")),(0,o.yg)("p",null,"Under the new type definition in ",(0,o.yg)("inlineCode",{parentName:"p"},"v4"),", the ",(0,o.yg)("inlineCode",{parentName:"p"},"resources")," array for our three resources should look like this:"),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-tsx",metastring:'title="resources prop array"',title:'"resources',prop:!0,'array"':!0},'[\n  {\n    name: "companies",\n    list: "/companies",\n    icon: <InfoCircleOutlined />,\n  },\n  {\n    name: "clients",\n    list: "/clients",\n    icon: <TeamOutlined />,\n  },\n  {\n    name: "contacts",\n    list: "/contacts",\n    edit: "/contacts/:id/edit",\n    icon: <UserAddOutlined />,\n  },\n];\n')),(0,o.yg)("p",null,"We can clearly see that instead of specifying the components for each view (for example, ",(0,o.yg)("inlineCode",{parentName:"p"},"list: CompanyList"),"), we are now assigning route paths."),(0,o.yg)("h3",{id:"adding-routes-to-refine-"},"Adding Routes to ",(0,o.yg)("inlineCode",{parentName:"h3"},"<Refine />")),(0,o.yg)("p",null,"In accordance with the path definitions in a resource object, we have to assign a ",(0,o.yg)("inlineCode",{parentName:"p"},"<Route />")," for each ",(0,o.yg)("inlineCode",{parentName:"p"},"path")," and an ",(0,o.yg)("inlineCode",{parentName:"p"},"element")," to display at that path. The route definitions for our three resources look like this:"),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-tsx",metastring:'title="Routing in v4"',title:'"Routing',in:!0,'v4"':!0},'<Refine>\n  <Routes>\n    <Route\n      element={\n        <Authenticated fallback={<CatchAllNavigate to="/login" />}>\n          <Layout Header={Header}>\n            <Outlet />\n          </Layout>\n        </Authenticated>\n      }\n    >\n      <Route index element={<NavigateToResource resource="companies" />} />\n      <Route path="/companies">\n        <Route index element={<CompanyList />} />\n      </Route>\n      <Route path="/clients">\n        <Route index element={<ClientList />} />\n      </Route>\n      <Route path="/contacts">\n        <Route index element={<ContactList />} />\n        <Route path="/contacts/:id/edit" element={<EditContact />} />\n      </Route>\n    </Route>\n  </Routes>\n</Refine>\n')),(0,o.yg)("p",null,"Notice that the parent ",(0,o.yg)("inlineCode",{parentName:"p"},"<Routes />")," component that overarches the routes is placed as a child of the ",(0,o.yg)("inlineCode",{parentName:"p"},"<Refine />")," component, and ",(0,o.yg)("strong",{parentName:"p"},"not")," as its prop. Also notice the nested ",(0,o.yg)("inlineCode",{parentName:"p"},"<Route />")," elements, suggesting deeper levels of nesting are possible due to the flexibility in version ",(0,o.yg)("inlineCode",{parentName:"p"},"v4"),"."),(0,o.yg)("h2",{id:"page-views-in-refine"},"Page Views in Refine"),(0,o.yg)("p",null,"As elaborated on ",(0,o.yg)("a",{parentName:"p",href:"https://refine.dev/blog/refine-react-invoice-generator-2/"},"Day Two"),", in order to display data on a view, the data provider methods have to be accessed from consumer components via corresponding data hooks. In other words, the pages specified in each ",(0,o.yg)("inlineCode",{parentName:"p"},"<Route />")," should invoke appropriate data hooks to fetch data for relevant CRUD actions taking place at that route."),(0,o.yg)("p",null,"Having this in mind, after importing all relevant page components for each resource route, the ",(0,o.yg)("inlineCode",{parentName:"p"},"<App />")," component now should look like below:"),(0,o.yg)("details",null,(0,o.yg)("summary",null,"Show App.tsx code"),(0,o.yg)("p",null,(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-tsx",metastring:'title="App.tsx"',title:'"App.tsx"'},'import { Authenticated, GitHubBanner, Refine } from "@refinedev/core";\nimport { RefineKbar, RefineKbarProvider } from "@refinedev/kbar";\n\nimport {\n  AuthPage,\n  ErrorComponent,\n  ThemedLayout,\n  useNotificationProvider,\n  ThemedTitle,\n} from "@refinedev/antd";\nimport "@refinedev/antd/dist/reset.css";\nimport * as Icons from "@ant-design/icons";\n\nconst { UserAddOutlined, TeamOutlined, InfoCircleOutlined } = Icons;\n\nimport routerBindings, {\n  CatchAllNavigate,\n  NavigateToResource,\n  UnsavedChangesNotifier,\n} from "@refinedev/react-router";\nimport { DataProvider } from "@refinedev/strapi-v4";\nimport { BrowserRouter, Outlet, Route, Routes } from "react-router-dom";\nimport { authProvider, axiosInstance } from "./authProvider";\nimport { Header } from "./components/header";\nimport { API_URL } from "./constants";\nimport { ColorModeContextProvider } from "./contexts/color-mode";\nimport { CompanyList } from "pages/companies";\nimport { ClientList } from "pages/clients";\nimport { ContactList, EditContact } from "pages/contacts";\n\nfunction App() {\n  return (\n    <BrowserRouter>\n      <GitHubBanner />\n      <RefineKbarProvider>\n        <ColorModeContextProvider>\n          <Refine\n            resources={[\n              {\n                name: "companies",\n                list: "/companies",\n                icon: <InfoCircleOutlined />,\n              },\n              {\n                name: "clients",\n                list: "/clients",\n                icon: <TeamOutlined />,\n              },\n              {\n                name: "contacts",\n                list: "/contacts",\n                edit: "/contacts/:id/edit",\n                icon: <UserAddOutlined />,\n              },\n            ]}\n            authProvider={authProvider}\n            dataProvider={DataProvider(API_URL + `/api`, axiosInstance)}\n            notificationProvider={useNotificationProvider}\n            routerProvider={routerBindings}\n            options={{\n              syncWithLocation: true,\n              warnWhenUnsavedChanges: true,\n            }}\n          >\n            <Routes>\n              <Route\n                element={\n                  <Authenticated fallback={<CatchAllNavigate to="/login" />}>\n                    <ThemedLayout\n                      Header={Header}\n                      Title={({ collapsed }) => (\n                        <ThemedTitleV2 collapsed={collapsed} text="Invoicer" />\n                      )}\n                    >\n                      <Outlet />\n                    </ThemedLayout>\n                  </Authenticated>\n                }\n              >\n                <Route\n                  index\n                  element={<NavigateToResource resource="companies" />}\n                />\n                <Route path="/companies">\n                  <Route index element={<CompanyList />} />\n                </Route>\n                <Route path="/clients">\n                  <Route index element={<ClientList />} />\n                </Route>\n                <Route path="/contacts">\n                  <Route index element={<ContactList />} />\n                  <Route path="/contacts/:id/edit" element={<EditContact />} />\n                </Route>\n              </Route>\n              <Route\n                element={\n                  <Authenticated fallback={<Outlet />}>\n                    <NavigateToResource />\n                  </Authenticated>\n                }\n              >\n                <Route\n                  path="/login"\n                  element={\n                    <AuthPage\n                      type="login"\n                      title={<ThemedTitleV2 collapsed text="Invoicer" />}\n                      formProps={{\n                        initialValues: {\n                          email: "demo@refine.dev",\n                          password: "demodemo",\n                        },\n                      }}\n                    />\n                  }\n                />\n              </Route>\n              <Route\n                element={\n                  <Authenticated>\n                    <ThemedLayout\n                      Header={Header}\n                      Title={({ collapsed }) => (\n                        <ThemedTitleV2 collapsed={collapsed} text="Invoicer" />\n                      )}\n                    >\n                      <Outlet />\n                    </ThemedLayout>\n                  </Authenticated>\n                }\n              >\n                <Route path="*" element={<ErrorComponent />} />\n              </Route>\n            </Routes>\n\n            <RefineKbar />\n            <UnsavedChangesNotifier />\n          </Refine>\n        </ColorModeContextProvider>\n      </RefineKbarProvider>\n    </BrowserRouter>\n  );\n}\n\nexport default App;\n')))),(0,o.yg)("p",null,"In the following sections, we explore these pages one by one for each resource along with their partial components and examine the hooks used to fetch and render data from the ",(0,o.yg)("strong",{parentName:"p"},"Strapi")," backend."),(0,o.yg)("h2",{id:"adding-views-for-companies"},"Adding Views for Companies"),(0,o.yg)("p",null,"For the ",(0,o.yg)("inlineCode",{parentName:"p"},"companies")," resource, our app should have ",(0,o.yg)("inlineCode",{parentName:"p"},"list"),", ",(0,o.yg)("inlineCode",{parentName:"p"},"create"),", ",(0,o.yg)("inlineCode",{parentName:"p"},"edit")," and ",(0,o.yg)("inlineCode",{parentName:"p"},"delete")," actions. In the following sections, as we add the necessary components, we also discuss what ",(0,o.yg)("inlineCode",{parentName:"p"},"dataProvider")," methods and data hooks we are using for these actions."),(0,o.yg)("h3",{id:"list-view-for-companies"},(0,o.yg)("inlineCode",{parentName:"h3"},"list")," View for ",(0,o.yg)("inlineCode",{parentName:"h3"},"companies")),(0,o.yg)("p",null,"The ",(0,o.yg)("inlineCode",{parentName:"p"},"list")," view is the page where a collection of resource item is displayed. It typically invokes the ",(0,o.yg)("inlineCode",{parentName:"p"},"dataProvider.getList()")," method which represents a ",(0,o.yg)("inlineCode",{parentName:"p"},"GET")," request to the backend API. The ",(0,o.yg)("inlineCode",{parentName:"p"},"dataProvider.getList()")," method can be accessed via the ",(0,o.yg)("inlineCode",{parentName:"p"},"useList()")," data hook."),(0,o.yg)("p",null,"The component rendered at the ",(0,o.yg)("inlineCode",{parentName:"p"},"list")," view at ",(0,o.yg)("inlineCode",{parentName:"p"},"/companies")," is ",(0,o.yg)("inlineCode",{parentName:"p"},"<CompanyList />"),". It looks like this:"),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-tsx",metastring:'title="src/pages/companies/list.tsx"',title:'"src/pages/companies/list.tsx"'},'import { HttpError } from "@refinedev/core";\nimport { useSimpleList, List, useModalForm } from "@refinedev/antd";\nimport { List as AntdList } from "antd";\n\nimport { ICompany } from "interfaces";\nimport { CompanyItem, CreateCompany, EditCompany } from "components/company";\n\nexport const CompanyList = () => {\n  const { listProps } = useSimpleList<ICompany>({\n    meta: { populate: ["logo"] },\n  });\n\n  const {\n    modalProps: createModalProps,\n    formProps: createFormProps,\n    show: createShow,\n  } = useModalForm<ICompany, HttpError, ICompany>({\n    action: "create",\n    meta: { populate: ["logo"] },\n  });\n\n  const {\n    modalProps: editModalProps,\n    formProps: editFormProps,\n    show: editShow,\n  } = useModalForm<ICompany, HttpError, ICompany>({\n    action: "edit",\n    meta: { populate: ["logo"] },\n  });\n\n  return (\n    <>\n      <List\n        createButtonProps={{\n          onClick: () => {\n            createShow();\n          },\n        }}\n      >\n        <AntdList\n          grid={{ gutter: 16 }}\n          {...listProps}\n          renderItem={(item) => (\n            <AntdList.Item>\n              <CompanyItem item={item} editShow={editShow} />\n            </AntdList.Item>\n          )}\n        />\n      </List>\n      <CreateCompany\n        modalProps={createModalProps}\n        formProps={createFormProps}\n      />\n      <EditCompany modalProps={editModalProps} formProps={editFormProps} />\n    </>\n  );\n};\nhere;\n')),(0,o.yg)("p",null,(0,o.yg)("strong",{parentName:"p"},(0,o.yg)("inlineCode",{parentName:"strong"},"useSimpleList()")," Hook in Refine")),(0,o.yg)("p",null,"We are using the ",(0,o.yg)("inlineCode",{parentName:"p"},"useSimpleList()")," data hook in the ",(0,o.yg)("inlineCode",{parentName:"p"},"<CompanyList />")," component. It is a higher level hook built on top of the ",(0,o.yg)("inlineCode",{parentName:"p"},"useList()")," hook that comes with the ",(0,o.yg)("inlineCode",{parentName:"p"},"@refinedev/antd")," package. ",(0,o.yg)("inlineCode",{parentName:"p"},"useList()")," is a low level ",(0,o.yg)("strong",{parentName:"p"},"Refine")," core hook."),(0,o.yg)("p",null,(0,o.yg)("inlineCode",{parentName:"p"},"useSimpleList()")," hook is being used to display our ",(0,o.yg)("inlineCode",{parentName:"p"},"companies")," data in a list. More details about the ",(0,o.yg)("inlineCode",{parentName:"p"},"useSimpleList()")," hook is available ",(0,o.yg)("a",{parentName:"p",href:"https://refine.dev/docs/api-reference/antd/hooks/list/useSimpleList/"},"here"),"."),(0,o.yg)("p",null,"Basically, the ",(0,o.yg)("inlineCode",{parentName:"p"},"useSimpleList()")," hook gives us access to the ",(0,o.yg)("inlineCode",{parentName:"p"},"dataProvider.getList")," method from inside the ",(0,o.yg)("inlineCode",{parentName:"p"},"<CompanyList />")," component. We are grabbing the ",(0,o.yg)("inlineCode",{parentName:"p"},"listProps")," object and passing it to the ",(0,o.yg)("inlineCode",{parentName:"p"},"<AntdList />"),", which is an ",(0,o.yg)("strong",{parentName:"p"},"Ant Design")," component that displays the items."),(0,o.yg)("p",null,"Detailed reference of the ",(0,o.yg)("strong",{parentName:"p"},"Ant Design")," ",(0,o.yg)("inlineCode",{parentName:"p"},"<List />")," component (imported as ",(0,o.yg)("inlineCode",{parentName:"p"},"<AntdList />"),") is available ",(0,o.yg)("a",{parentName:"p",href:"https://ant.design/components/list#api"},"here"),"."),(0,o.yg)("h3",{id:"company-create-action"},"Company ",(0,o.yg)("inlineCode",{parentName:"h3"},"create")," Action"),(0,o.yg)("p",null,"Take a note of the ",(0,o.yg)("inlineCode",{parentName:"p"},"<List />")," component in the ",(0,o.yg)("inlineCode",{parentName:"p"},"<CompanyList />")," page. And especially the ",(0,o.yg)("inlineCode",{parentName:"p"},"createButtonProps")," prop. ",(0,o.yg)("inlineCode",{parentName:"p"},"<List />")," is an ",(0,o.yg)("strong",{parentName:"p"},"refine-Ant Design")," component that by default places a ",(0,o.yg)("inlineCode",{parentName:"p"},"<CreateButton />")," inside its header. This button's ",(0,o.yg)("inlineCode",{parentName:"p"},"onClick")," props can be customized by setting the ",(0,o.yg)("inlineCode",{parentName:"p"},"createButtonsProps")," prop of ",(0,o.yg)("inlineCode",{parentName:"p"},"<List />"),"."),(0,o.yg)("p",null,"For example, with the below object, we are setting the behavior of the button to show the modal by invoking ",(0,o.yg)("inlineCode",{parentName:"p"},"createShow()")," on the click event:"),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-tsx"}," createButtonProps={{\n    onClick: () => {\n        createShow();\n    },\n}}\n")),(0,o.yg)("p",null,"More elaboration about it is available in the ",(0,o.yg)("a",{parentName:"p",href:"https://refine.dev/docs/api-reference/antd/components/basic-views/list/#cancreate-and-createbuttonprops"},"docs section here"),"."),(0,o.yg)("p",null,"In the ",(0,o.yg)("inlineCode",{parentName:"p"},"<CompanyList />")," page above, by specifying the value of ",(0,o.yg)("inlineCode",{parentName:"p"},"createButtonProps")," prop for ",(0,o.yg)("inlineCode",{parentName:"p"},"<List />"),", we are activating the ",(0,o.yg)("inlineCode",{parentName:"p"},"<CreateButton />"),". And then we are invoking the ",(0,o.yg)("inlineCode",{parentName:"p"},"createShow")," modal function for the ",(0,o.yg)("inlineCode",{parentName:"p"},"onClick")," event on the button."),(0,o.yg)("br",null),(0,o.yg)("p",null,(0,o.yg)("strong",{parentName:"p"},(0,o.yg)("inlineCode",{parentName:"strong"},"useModalForm()")," Hook in Refine")),(0,o.yg)("p",null,"Stepping back to the ",(0,o.yg)("inlineCode",{parentName:"p"},"<CompanyList />")," component, we can see that ",(0,o.yg)("inlineCode",{parentName:"p"},"useModalForm()")," hook is used to invoke the ",(0,o.yg)("inlineCode",{parentName:"p"},"dataProvider.create")," method."),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-tsx"},'const {\n  modalProps: createModalProps,\n  formProps: createFormProps,\n  show: createShow,\n} = useModalForm<ICompany, HttpError, ICompany>({\n  action: "create",\n  meta: { populate: ["logo"] },\n});\n')),(0,o.yg)("p",null,"We are picking ",(0,o.yg)("inlineCode",{parentName:"p"},"modalProps")," and ",(0,o.yg)("inlineCode",{parentName:"p"},"formProps")," and passing them to the ",(0,o.yg)("inlineCode",{parentName:"p"},"<CreateCompany />")," modal. To get more comprehensive understanding, please feel free to go over the ",(0,o.yg)("a",{parentName:"p",href:"https://refine.dev/docs/api-reference/antd/hooks/form/useModalForm/"},(0,o.yg)("inlineCode",{parentName:"a"},"useModalForm()")," API reference here"),"."),(0,o.yg)("p",null,(0,o.yg)("strong",{parentName:"p"},"refine-Ant Design ",(0,o.yg)("inlineCode",{parentName:"strong"},"<Modal />")," Component")),(0,o.yg)("p",null,"The modal itself is contained in ",(0,o.yg)("inlineCode",{parentName:"p"},"<CreateCompany />")," and has the following content:"),(0,o.yg)("details",null,(0,o.yg)("summary",null,"Show CreateCompany source code"),(0,o.yg)("p",null,(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-tsx"},'import { useApiUrl } from "@refinedev/core";\nimport { Modal, Form, Input, Grid, ModalProps, FormProps, Upload } from "antd";\n\nimport {\n  useStrapiUpload,\n  getValueProps,\n  mediaUploadMapper,\n} from "@refinedev/strapi-v4";\n\nimport { TOKEN_KEY } from "../../constants";\n\ntype CreateCompanyProps = {\n  modalProps: ModalProps;\n  formProps: FormProps;\n};\n\nexport const CreateCompany: React.FC<CreateCompanyProps> = ({\n  modalProps,\n  formProps,\n}) => {\n  const breakpoint = Grid.useBreakpoint();\n  const { ...uploadProps } = useStrapiUpload({\n    maxCount: 1,\n  });\n  const API_URL = useApiUrl();\n\n  return (\n    <Modal\n      {...modalProps}\n      title="Create Company"\n      width={breakpoint.sm ? "600px" : "80%"}\n    >\n      <Form\n        {...formProps}\n        layout="vertical"\n        onFinish={(values) => {\n          console.log(values);\n          return formProps.onFinish?.({\n            ...mediaUploadMapper(values),\n          });\n        }}\n      >\n        <Form.Item\n          label="Company Name"\n          name="name"\n          rules={[\n            {\n              required: true,\n            },\n          ]}\n        >\n          <Input />\n        </Form.Item>\n        <Form.Item label="Company Address" name="address">\n          <Input />\n        </Form.Item>\n        <Form.Item label="Company Country" name="country">\n          <Input />\n        </Form.Item>\n        <Form.Item label="Company City" name="city">\n          <Input />\n        </Form.Item>\n        <Form.Item\n          label="Email"\n          name="email"\n          rules={[\n            {\n              required: true,\n              type: "email",\n            },\n          ]}\n        >\n          <Input />\n        </Form.Item>\n        <Form.Item label="Website" name="website">\n          <Input />\n        </Form.Item>\n        <Form.Item label="Company Logo">\n          <Form.Item\n            name={"logo"}\n            valuePropName="fileList"\n            getValueProps={(data) => getValueProps(data, API_URL)}\n            noStyle\n            rules={[\n              {\n                required: true,\n              },\n            ]}\n          >\n            <Upload.Dragger\n              name="files"\n              action={`${API_URL}/upload`}\n              headers={{\n                Authorization: `Bearer ${localStorage.getItem(TOKEN_KEY)}`,\n              }}\n              listType="picture"\n              multiple\n              {...uploadProps}\n            >\n              <p className="ant-upload-text">Drag & drop a file in this area</p>\n            </Upload.Dragger>\n          </Form.Item>\n        </Form.Item>\n      </Form>\n    </Modal>\n  );\n};\n')))),(0,o.yg)("p",null,"There are several things to emphasize around the modal here. First, the ",(0,o.yg)("inlineCode",{parentName:"p"},"modalProps")," prop passed to the ",(0,o.yg)("inlineCode",{parentName:"p"},"<Modal />")," component allows the operation of the modal. Second, the ",(0,o.yg)("inlineCode",{parentName:"p"},"formProps")," is used to manipulate and fetch form data for the ",(0,o.yg)("inlineCode",{parentName:"p"},"create")," action. And third, the use of the ",(0,o.yg)("inlineCode",{parentName:"p"},"useStrapiUpload()")," hook that comes from ",(0,o.yg)("inlineCode",{parentName:"p"},"@refinedev/strapi-v4")," that is used to upload ",(0,o.yg)("inlineCode",{parentName:"p"},"logo")," for a company."),(0,o.yg)("br",null),(0,o.yg)("p",null,(0,o.yg)("strong",{parentName:"p"},"Refine ",(0,o.yg)("inlineCode",{parentName:"strong"},"<Form />")," Component")),(0,o.yg)("p",null,"The ",(0,o.yg)("inlineCode",{parentName:"p"},"formProps")," are tailored according to and passed to the ",(0,o.yg)("strong",{parentName:"p"},"Ant Design")," ",(0,o.yg)("inlineCode",{parentName:"p"},"<Form />")," component. If we look closer, the form ",(0,o.yg)("inlineCode",{parentName:"p"},"values")," are passed to the ",(0,o.yg)("inlineCode",{parentName:"p"},"onFinish")," event handler for send a ",(0,o.yg)("inlineCode",{parentName:"p"},"POST")," request. More information on the ",(0,o.yg)("inlineCode",{parentName:"p"},"<Form />")," component is available ",(0,o.yg)("a",{parentName:"p",href:"https://ant.design/components/form#form"},"here"),"."),(0,o.yg)("h3",{id:"company-edit-and-delete-actions"},"Company ",(0,o.yg)("inlineCode",{parentName:"h3"},"edit")," and ",(0,o.yg)("inlineCode",{parentName:"h3"},"delete")," Actions"),(0,o.yg)("p",null,"We are rendering a ",(0,o.yg)("inlineCode",{parentName:"p"},"<CompanyItem />")," component inside the ",(0,o.yg)("inlineCode",{parentName:"p"},"<CompanyList />")," page. Its content looks like this:"),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-tsx",metastring:'title="src/components/company/item.tsx"',title:'"src/components/company/item.tsx"'},'import {\n  DeleteButton,\n  UrlField,\n  EmailField,\n  EditButton,\n} from "@refinedev/antd";\nimport { Card, Typography } from "antd";\n\nimport { ICompany } from "interfaces";\nimport { API_URL } from "../../constants";\n\nconst { Title, Text } = Typography;\n\ntype CompanyItemProps = {\n  item: ICompany;\n  editShow: (id?: string | undefined) => void;\n};\n\nexport const CompanyItem: React.FC<CompanyItemProps> = ({ item, editShow }) => {\n  const image = item.logo ? API_URL + item.logo.url : "./error.png";\n\n  return (\n    <Card\n      style={{ width: "300px" }}\n      cover={\n        <div style={{ display: "flex", justifyContent: "center" }}>\n          <img\n            style={{\n              width: 220,\n              height: 100,\n              padding: 24,\n            }}\n            src={image}\n            alt="logo"\n          />\n        </div>\n      }\n      actions={[\n        <EditButton\n          key="edit"\n          size="small"\n          hideText\n          onClick={() => editShow(item.id)}\n        />,\n        <DeleteButton\n          key="delete"\n          size="small"\n          hideText\n          recordItemId={item.id}\n        />,\n      ]}\n    >\n      <Title level={5}>Company Name:</Title>\n      <Text>{item.name}</Text>\n      <Title level={5}>Company Address:</Title>\n      <Text>{item.address}</Text>\n      <Title level={5}>County:</Title>\n      <Text>{item.country}</Text>\n      <Title level={5}>City:</Title>\n      <Text>{item.city}</Text>\n      <Title level={5}>Email:</Title>\n      <EmailField value={item.email} />\n      <Title level={5}>Website:</Title>\n      <UrlField value={item.website} />\n    </Card>\n  );\n};\n')),(0,o.yg)("p",null,"In the above code, the ",(0,o.yg)("a",{parentName:"p",href:"https://refine.dev/docs/api-reference/antd/components/buttons/edit-button/"},(0,o.yg)("inlineCode",{parentName:"a"},"<EditButton />"))," and ",(0,o.yg)("a",{parentName:"p",href:"https://refine.dev/docs/api-reference/antd/components/buttons/delete-button/"},(0,o.yg)("inlineCode",{parentName:"a"},"<DeleteButton />"))," components are provided by the ",(0,o.yg)("inlineCode",{parentName:"p"},"@refinedev/antd")," package."),(0,o.yg)("p",null,"The ",(0,o.yg)("inlineCode",{parentName:"p"},"<EditButton />")," opens up the ",(0,o.yg)("inlineCode",{parentName:"p"},"<EditCompany />")," modal when clicked. It uses a separate instance of the ",(0,o.yg)("inlineCode",{parentName:"p"},"useModalForm()")," hook for forwarding editable data to the ",(0,o.yg)("inlineCode",{parentName:"p"},"edit")," action inside ",(0,o.yg)("inlineCode",{parentName:"p"},"<EditCompany />"),":"),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-tsx"},'const {\n  modalProps: editModalProps,\n  formProps: editFormProps,\n  show: editShow,\n} = useModalForm<ICompany, HttpError, ICompany>({\n  action: "edit",\n  meta: { populate: ["logo"] },\n});\n')),(0,o.yg)("p",null,"The ",(0,o.yg)("inlineCode",{parentName:"p"},"<DeleteButton />"),", on the other hand, implements ",(0,o.yg)("inlineCode",{parentName:"p"},"delete")," action on a ",(0,o.yg)("inlineCode",{parentName:"p"},"companies")," item."),(0,o.yg)("p",null,"These are pretty much everything we need for the ",(0,o.yg)("inlineCode",{parentName:"p"},"list"),", ",(0,o.yg)("inlineCode",{parentName:"p"},"create"),", ",(0,o.yg)("inlineCode",{parentName:"p"},"edit")," and ",(0,o.yg)("inlineCode",{parentName:"p"},"delete")," actions on ",(0,o.yg)("inlineCode",{parentName:"p"},"companies")," resource."),(0,o.yg)("p",null,"At this point, let's run the ",(0,o.yg)("strong",{parentName:"p"},"Refine")," server and the ",(0,o.yg)("strong",{parentName:"p"},"Strapi")," server at ",(0,o.yg)("inlineCode",{parentName:"p"},"http://localhost:1337"),". And we should be presented with a login screen at ",(0,o.yg)("inlineCode",{parentName:"p"},"http://localhost:3000/login"),":"),(0,o.yg)("img",{style:{alignSelf:"center"},src:"https://refine.ams3.cdn.digitaloceanspaces.com/blog/2023-04-12-refine-invoicer-3/login.png",alt:"react invoice generator"}),(0,o.yg)("br",null),(0,o.yg)("h3",{id:"email-authentication-with-strapi-in-refine"},"Email Authentication with Strapi in Refine"),(0,o.yg)("p",null,"The login in screen is encountered because when we asked the ",(0,o.yg)("strong",{parentName:"p"},"Refine")," ",(0,o.yg)("strong",{parentName:"p"},"CLI Wizard")," to generate example pages at project initialization, the ",(0,o.yg)("inlineCode",{parentName:"p"},"authProvider")," came enabled with them:"),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-tsx",metastring:'title="src/App.tsx"',title:'"src/App.tsx"'},"<Refine authProvider={authProvider} />\n")),(0,o.yg)("p",null,"The routing and components involved are the following:"),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-tsx"},'<Routes>\n  <Route\n    element={\n      <Authenticated fallback={<Outlet />}>\n        <NavigateToResource />\n      </Authenticated>\n    }\n  >\n    <Route\n      path="/login"\n      element={\n        <AuthPage\n          type="login"\n          title={<ThemedTitleV2 collapsed text="Invoicer" />}\n          formProps={{\n            initialValues: {\n              email: "demo@refine.dev",\n              password: "demodemo",\n            },\n          }}\n        />\n      }\n    />\n  </Route>\n</Routes>\n')),(0,o.yg)("br",null),(0,o.yg)("h3",{id:"refine-ant-design-authpage--component"},"refine-Ant Design ",(0,o.yg)("inlineCode",{parentName:"h3"},"<AuthPage /")," Component"),(0,o.yg)("p",null,"The component being rendered at ",(0,o.yg)("inlineCode",{parentName:"p"},"/login")," is the ",(0,o.yg)("strong",{parentName:"p"},"refine-Ant Design")," ",(0,o.yg)("inlineCode",{parentName:"p"},"<AuthPage />")," component which is provided by the ",(0,o.yg)("inlineCode",{parentName:"p"},"@refinedev/antd")," package. The ",(0,o.yg)("inlineCode",{parentName:"p"},"<AuthPage />")," component is a special component that has variants for ",(0,o.yg)("inlineCode",{parentName:"p"},"login"),", ",(0,o.yg)("inlineCode",{parentName:"p"},"register"),", ",(0,o.yg)("inlineCode",{parentName:"p"},"forgotPassword")," and ",(0,o.yg)("inlineCode",{parentName:"p"},"updatePassword"),", which are generated based on the prop passed. For example in the code snippet above, we are asking for the ",(0,o.yg)("inlineCode",{parentName:"p"},"login")," type of the ",(0,o.yg)("inlineCode",{parentName:"p"},"<AuthPage />")," component at the ",(0,o.yg)("inlineCode",{parentName:"p"},"/login")," route."),(0,o.yg)("p",null,"More on the ",(0,o.yg)("inlineCode",{parentName:"p"},"<AuthPage />")," component is available ",(0,o.yg)("a",{parentName:"p",href:"https://refine.dev/docs/api-reference/antd/components/antd-auth-page/"},"here"),"."),(0,o.yg)("p",null,"At this point, if we attempt to log in to our ",(0,o.yg)("strong",{parentName:"p"},"Pdf Invoice Generator")," app using the default credentials on the form, we should be redirected to the ",(0,o.yg)("inlineCode",{parentName:"p"},"/companies")," route. And we should expect a blank page."),(0,o.yg)("p",null,"When we create a few companies, they should be displayed in the page:"),(0,o.yg)("img",{style:{alignSelf:"center"},src:"https://refine.ams3.cdn.digitaloceanspaces.com/blog/2023-04-12-refine-invoicer-3/compaines.png",alt:"react invoice generator"}),(0,o.yg)("br",null),(0,o.yg)("p",null,"We can go about editing company details from a modal and also delete a company."),(0,o.yg)("p",null,"The app redirects to ",(0,o.yg)("inlineCode",{parentName:"p"},"/companies"),", because ",(0,o.yg)("strong",{parentName:"p"},"Refine")," sets the root route to be ",(0,o.yg)("inlineCode",{parentName:"p"},"list")," path of the first resource item of the array passed to ",(0,o.yg)("inlineCode",{parentName:"p"},"resources"),". If we look back into the ",(0,o.yg)("inlineCode",{parentName:"p"},"resources")," array, we know that it's the ",(0,o.yg)("inlineCode",{parentName:"p"},"companies")," resource."),(0,o.yg)("h2",{id:"adding-views-for-clients"},"Adding Views for ",(0,o.yg)("inlineCode",{parentName:"h2"},"clients")),(0,o.yg)("p",null,"Now it's time to turn our attention back to CRUD actions. Let's implement views for the ",(0,o.yg)("inlineCode",{parentName:"p"},"clients")," resource."),(0,o.yg)("p",null,"We already completed the ",(0,o.yg)("inlineCode",{parentName:"p"},"resource")," object and route definitions for ",(0,o.yg)("inlineCode",{parentName:"p"},"clients")," previously. We now need to introduce the page and partial components."),(0,o.yg)("h3",{id:"list-view-for-clients"},(0,o.yg)("inlineCode",{parentName:"h3"},"list")," View for ",(0,o.yg)("inlineCode",{parentName:"h3"},"clients")),(0,o.yg)("p",null,"In a similar vein to the ",(0,o.yg)("inlineCode",{parentName:"p"},"<CompanyList />")," component, the ",(0,o.yg)("inlineCode",{parentName:"p"},"<ClientList />")," page looks like this:"),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-tsx",metastring:'title="src/pages/clients/list.tsx"',title:'"src/pages/clients/list.tsx"'},'import { HttpError } from "@refinedev/core";\nimport {\n  useSimpleList,\n  List,\n  useDrawerForm,\n  CreateButton,\n} from "@refinedev/antd";\nimport { List as AntdList } from "antd";\n\nimport { IClient } from "interfaces";\nimport { ClientItem, CreateClient, EditClient } from "components/client";\n\nexport const ClientList = () => {\n  const { listProps } = useSimpleList<IClient>({\n    meta: { populate: ["contacts"] },\n  });\n\n  const {\n    drawerProps: createDrawerProps,\n    formProps: createFormProps,\n    saveButtonProps: createSaveButtonProps,\n    show: createShow,\n  } = useDrawerForm<IClient, HttpError, IClient>({\n    action: "create",\n    resource: "clients",\n    redirect: false,\n  });\n\n  const {\n    drawerProps: editDrawerProps,\n    formProps: editFormProps,\n    saveButtonProps: editSaveButtonProps,\n    show: editShow,\n  } = useDrawerForm<IClient, HttpError, IClient>({\n    action: "edit",\n    resource: "clients",\n    redirect: false,\n  });\n\n  return (\n    <>\n      <List\n        headerProps={{\n          extra: <CreateButton onClick={() => createShow()} />,\n        }}\n      >\n        <AntdList\n          grid={{ gutter: 24, xs: 1 }}\n          {...listProps}\n          renderItem={(item) => (\n            <AntdList.Item>\n              <ClientItem item={item} editShow={editShow} />\n            </AntdList.Item>\n          )}\n        />\n      </List>\n      <CreateClient\n        drawerProps={createDrawerProps}\n        formProps={createFormProps}\n        saveButtonProps={createSaveButtonProps}\n      />\n      <EditClient\n        drawerProps={editDrawerProps}\n        formProps={editFormProps}\n        saveButtonProps={editSaveButtonProps}\n      />\n    </>\n  );\n};\n')),(0,o.yg)("p",null,"Like in the ",(0,o.yg)("inlineCode",{parentName:"p"},"<CompanyList />")," component, we are leveraging ",(0,o.yg)("inlineCode",{parentName:"p"},"useSimpleList()")," to fetch data from the ",(0,o.yg)("inlineCode",{parentName:"p"},"/clients")," ",(0,o.yg)("strong",{parentName:"p"},"Strapi")," endpoint and the received data is tailored to suit to the props of ",(0,o.yg)("inlineCode",{parentName:"p"},"<AntdList />")," component, which renders the client data in a list."),(0,o.yg)("h3",{id:"create-and-edit-actions-for-clients"},(0,o.yg)("inlineCode",{parentName:"h3"},"create")," and ",(0,o.yg)("inlineCode",{parentName:"h3"},"edit")," Actions for ",(0,o.yg)("inlineCode",{parentName:"h3"},"clients")),(0,o.yg)("p",null,"Similar to the ",(0,o.yg)("inlineCode",{parentName:"p"},"<CompanyList />")," page, the ",(0,o.yg)("inlineCode",{parentName:"p"},"<List />")," component in the ",(0,o.yg)("inlineCode",{parentName:"p"},"<ClientList />")," page gets a ",(0,o.yg)("inlineCode",{parentName:"p"},"<CreateButton />"),", this time from its ",(0,o.yg)("inlineCode",{parentName:"p"},"headerProps")," prop. Clicking on the button slides a ",(0,o.yg)("inlineCode",{parentName:"p"},"<CreateClient />")," component which is derived from the ",(0,o.yg)("strong",{parentName:"p"},"Ant Design")," ",(0,o.yg)("inlineCode",{parentName:"p"},"<Drawer />")," component. The ",(0,o.yg)("inlineCode",{parentName:"p"},"drawerProps")," containing fetched data is supplied by ",(0,o.yg)("strong",{parentName:"p"},"refine-Ant Design"),"'s ",(0,o.yg)("inlineCode",{parentName:"p"},"useDrawerForm()")," hook:"),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-tsx"},'const {\n  drawerProps: createDrawerProps,\n  formProps: createFormProps,\n  saveButtonProps: createSaveButtonProps,\n  show: createShow,\n} = useDrawerForm<IClient, HttpError, IClient>({\n  action: "create",\n  resource: "clients",\n  redirect: false,\n});\n')),(0,o.yg)("p",null,(0,o.yg)("strong",{parentName:"p"},"refine-Ant Design's ",(0,o.yg)("inlineCode",{parentName:"strong"},"useDrawerForm()")," Hook")),(0,o.yg)("p",null,"In the snippet above, we are picking ",(0,o.yg)("inlineCode",{parentName:"p"},"drawerProps"),", ",(0,o.yg)("inlineCode",{parentName:"p"},"formProps")," and ",(0,o.yg)("inlineCode",{parentName:"p"},"saveButtonProps")," and passing them to the ",(0,o.yg)("inlineCode",{parentName:"p"},"<CreateClient />")," component."),(0,o.yg)("p",null,"The ",(0,o.yg)("inlineCode",{parentName:"p"},"<CreateClient />")," component looks like this:"),(0,o.yg)("details",null,(0,o.yg)("summary",null,"Show CreateClient code"),(0,o.yg)("p",null,(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-tsx",metastring:'title="src/components/client/create.tsx"',title:'"src/components/client/create.tsx"'},'import { Create, useSelect, useModalForm } from "@refinedev/antd";\n\nimport {\n  Drawer,\n  DrawerProps,\n  Form,\n  FormProps,\n  Input,\n  ButtonProps,\n  Grid,\n  Select,\n  Button,\n} from "antd";\n\nimport { IContact } from "interfaces";\nimport { CreateContact } from "components/contact";\n\ntype CreateClientProps = {\n  drawerProps: DrawerProps;\n  formProps: FormProps;\n  saveButtonProps: ButtonProps;\n};\n\nexport const CreateClient: React.FC<CreateClientProps> = ({\n  drawerProps,\n  formProps,\n  saveButtonProps,\n}) => {\n  const breakpoint = Grid.useBreakpoint();\n\n  const { selectProps } = useSelect<IContact>({\n    resource: "contacts",\n    optionLabel: "first_name",\n\n    pagination: {\n      mode: "server",\n    },\n  });\n\n  const {\n    formProps: createContactFormProps,\n    modalProps,\n    show,\n  } = useModalForm({\n    resource: "contacts",\n    action: "create",\n    redirect: false,\n  });\n\n  return (\n    <>\n      <Drawer\n        {...drawerProps}\n        width={breakpoint.sm ? "500px" : "100%"}\n        bodyStyle={{ padding: 0 }}\n      >\n        <Create saveButtonProps={saveButtonProps}>\n          <Form\n            {...formProps}\n            layout="vertical"\n            initialValues={{\n              isActive: true,\n            }}\n          >\n            <Form.Item\n              label="Client Company Name"\n              name="name"\n              rules={[\n                {\n                  required: true,\n                },\n              ]}\n            >\n              <Input />\n            </Form.Item>\n            <Form.Item label="Select Contact">\n              <div style={{ display: "flex" }}>\n                <Form.Item name={"contacts"} noStyle>\n                  <Select {...selectProps} mode="multiple" />\n                </Form.Item>\n                <Button type="link" onClick={() => show()}>\n                  Create Contact\n                </Button>\n              </div>\n            </Form.Item>\n          </Form>\n        </Create>\n      </Drawer>\n\n      <CreateContact\n        modalProps={modalProps}\n        formProps={createContactFormProps}\n      />\n    </>\n  );\n};\n')))),(0,o.yg)("p",null,"The ",(0,o.yg)("inlineCode",{parentName:"p"},"formProps")," is tailored to match the props of the ",(0,o.yg)("strong",{parentName:"p"},"Ant Design")," ",(0,o.yg)("inlineCode",{parentName:"p"},"<Form />")," component and by specifying ",(0,o.yg)("inlineCode",{parentName:"p"},'action: "create"'),", we are sending a ",(0,o.yg)("inlineCode",{parentName:"p"},"POST")," request to ",(0,o.yg)("inlineCode",{parentName:"p"},"/clients")," endpoint in our ",(0,o.yg)("strong",{parentName:"p"},"Strapi")," app."),(0,o.yg)("p",null,"Please feel free to explore the ",(0,o.yg)("a",{parentName:"p",href:"https://refine.dev/docs/api-reference/antd/hooks/form/useDrawerForm/"},(0,o.yg)("inlineCode",{parentName:"a"},"useDrawerForm()")," documentation")," for more details."),(0,o.yg)("p",null,"Our ",(0,o.yg)("inlineCode",{parentName:"p"},"edit")," action for ",(0,o.yg)("inlineCode",{parentName:"p"},"clients"),", similar to the ",(0,o.yg)("inlineCode",{parentName:"p"},"create")," action, also leverages ",(0,o.yg)("inlineCode",{parentName:"p"},"useDrawerForm()")," hook to manage operations and fetch data for the ",(0,o.yg)("inlineCode",{parentName:"p"},"<EditClient />")," component:"),(0,o.yg)("details",null,(0,o.yg)("summary",null,"Show EditClient code"),(0,o.yg)("p",null,(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-tsx",metastring:'title="src/components/client/edit.tsx"',title:'"src/components/client/edit.tsx"'},'import { Edit, useSelect } from "@refinedev/antd";\nimport {\n  Drawer,\n  DrawerProps,\n  Form,\n  FormProps,\n  Input,\n  ButtonProps,\n  Grid,\n  Select,\n} from "antd";\n\ntype EditClientProps = {\n  drawerProps: DrawerProps;\n  formProps: FormProps;\n  saveButtonProps: ButtonProps;\n};\n\nexport const EditClient: React.FC<EditClientProps> = ({\n  drawerProps,\n  formProps,\n  saveButtonProps,\n}) => {\n  const breakpoint = Grid.useBreakpoint();\n\n  const { selectProps } = useSelect({\n    resource: "contacts",\n    optionLabel: "first_name",\n\n    pagination: {\n      mode: "server",\n    },\n  });\n\n  return (\n    <Drawer\n      {...drawerProps}\n      width={breakpoint.sm ? "500px" : "100%"}\n      bodyStyle={{ padding: 0 }}\n    >\n      <Edit\n        saveButtonProps={saveButtonProps}\n        title={\n          <h4 style={{ padding: "0 24px", fontWeight: "bold" }}>Edit Client</h4>\n        }\n      >\n        <Form\n          {...formProps}\n          layout="vertical"\n          initialValues={{\n            isActive: true,\n            ...formProps.initialValues,\n          }}\n        >\n          <Form.Item\n            label="Client Company Name"\n            name="name"\n            rules={[\n              {\n                required: true,\n              },\n            ]}\n          >\n            <Input />\n          </Form.Item>\n          <Form.Item label="Select Contact" name="contacts">\n            <Select {...selectProps} mode="multiple" />\n          </Form.Item>\n        </Form>\n      </Edit>\n    </Drawer>\n  );\n};\n')))),(0,o.yg)("p",null,"This is also built on the ",(0,o.yg)("inlineCode",{parentName:"p"},"<Drawer />")," component. Please refer to ",(0,o.yg)("a",{parentName:"p",href:"https://ant.design/components/drawer"},(0,o.yg)("strong",{parentName:"a"},"Ant Design")," documentation for ",(0,o.yg)("inlineCode",{parentName:"a"},"<Drawer />"))," for further examination."),(0,o.yg)("h3",{id:"delete-action-for-clients"},(0,o.yg)("inlineCode",{parentName:"h3"},"delete")," Action for ",(0,o.yg)("inlineCode",{parentName:"h3"},"clients")),(0,o.yg)("p",null,"The ",(0,o.yg)("inlineCode",{parentName:"p"},"delete")," action is performed from inside the ",(0,o.yg)("inlineCode",{parentName:"p"},"<ClientItem />")," component. It looks like this:"),(0,o.yg)("details",null,(0,o.yg)("summary",null,"Show ClientItemcode"),(0,o.yg)("p",null,(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-tsx",metastring:'title="src/components/client/item.tsx"',title:'"src/components/client/item.tsx"'},'import { useDelete } from "@refinedev/core";\nimport { TagField } from "@refinedev/antd";\n\nimport * as Icons from "@ant-design/icons";\nimport { Card, Typography, Dropdown, Menu } from "antd";\nimport { IClient } from "interfaces";\n\nconst { FormOutlined, DeleteOutlined } = Icons;\nconst { Title, Text } = Typography;\n\ntype ClientItemProps = {\n  item: IClient;\n  editShow: (id?: string | undefined) => void;\n};\n\nexport const ClientItem: React.FC<ClientItemProps> = ({ item, editShow }) => {\n  const { mutate } = useDelete();\n\n  return (\n    <Card style={{ width: 300, height: 300, borderColor: "black" }}>\n      <div style={{ position: "absolute", top: "10px", right: "5px" }}>\n        <Dropdown\n          overlay={\n            <Menu mode="vertical">\n              <Menu.Item\n                key="1"\n                style={{\n                  fontWeight: 500,\n                }}\n                icon={\n                  <FormOutlined\n                    style={{\n                      color: "green",\n                    }}\n                  />\n                }\n                onClick={() => editShow(item.id)}\n              >\n                Edit Client\n              </Menu.Item>\n              <Menu.Item\n                key="2"\n                style={{\n                  fontWeight: 500,\n                }}\n                icon={\n                  <DeleteOutlined\n                    style={{\n                      color: "red",\n                    }}\n                  />\n                }\n                onClick={() =>\n                  mutate({\n                    resource: "clients",\n                    id: item.id,\n                    mutationMode: "undoable",\n                    undoableTimeout: 5000,\n                  })\n                }\n              >\n                Delete Client\n              </Menu.Item>\n            </Menu>\n          }\n          trigger={["click"]}\n        >\n          <Icons.MoreOutlined\n            style={{\n              fontSize: 24,\n            }}\n          />\n        </Dropdown>\n      </div>\n\n      <Title level={4}>{item.name}</Title>\n      <Title level={5}>Client Id:</Title>\n      <Text>{item.id}</Text>\n      <Title level={5}>Contacts:</Title>\n\n      {item.contacts.map((item) => {\n        return (\n          <TagField\n            key={item.id}\n            style={{ marginTop: 4 }}\n            color={"#673ab7"}\n            value={`${item.first_name} ${item.last_name}`}\n          />\n        );\n      })}\n    </Card>\n  );\n};\n')))),(0,o.yg)("p",null,"We are invoking ",(0,o.yg)("inlineCode",{parentName:"p"},"useDelete()")," hook and picking the ",(0,o.yg)("inlineCode",{parentName:"p"},"mutate()")," function for deleting a client. It is bound to the ",(0,o.yg)("inlineCode",{parentName:"p"},"onClick")," event of the ",(0,o.yg)("inlineCode",{parentName:"p"},"Delete Client")," button. The ",(0,o.yg)("inlineCode",{parentName:"p"},"mutate()")," function is used to access and invoke the ",(0,o.yg)("inlineCode",{parentName:"p"},"dataProvider.delete")," method."),(0,o.yg)("p",null,"With these views completed, now we should be able to create, list, update and delete ",(0,o.yg)("inlineCode",{parentName:"p"},"clients")," records from within our ",(0,o.yg)("strong",{parentName:"p"},"Refine")," app."),(0,o.yg)("img",{style:{alignSelf:"center"},src:"https://refine.ams3.cdn.digitaloceanspaces.com/blog/2023-04-12-refine-invoicer-3/clients.png",alt:"react invoice generator"}),(0,o.yg)("br",null),(0,o.yg)("h2",{id:"adding-views-for-contacts"},"Adding Views for ",(0,o.yg)("inlineCode",{parentName:"h2"},"contacts")),(0,o.yg)("p",null,"Now it's the turn to add views for ",(0,o.yg)("inlineCode",{parentName:"p"},"contacts"),". As we can see, ",(0,o.yg)("strong",{parentName:"p"},"Refine")," is heavily opinionated about RESTful conventions and CRUD actions can be implemented conveniently with a multitude of hooks that match appropriate ",(0,o.yg)("strong",{parentName:"p"},"Ant Design"),"-based components."),(0,o.yg)("p",null,"The ",(0,o.yg)("inlineCode",{parentName:"p"},"useTable()")," hook, for example, is very useful to create list views with tables."),(0,o.yg)("h3",{id:"list-view-for-contacts"},(0,o.yg)("inlineCode",{parentName:"h3"},"list")," View for ",(0,o.yg)("inlineCode",{parentName:"h3"},"contacts")),(0,o.yg)("p",null,"The ",(0,o.yg)("inlineCode",{parentName:"p"},"list")," view for ",(0,o.yg)("inlineCode",{parentName:"p"},"contacts")," makes use of the ",(0,o.yg)("inlineCode",{parentName:"p"},"useTable()")," hook to present contacts information in a table using the ",(0,o.yg)("strong",{parentName:"p"},"Ant Design")," ",(0,o.yg)("inlineCode",{parentName:"p"},"<Table />")," component. The page looks like below:"),(0,o.yg)("details",null,(0,o.yg)("summary",null,"Show Contact list view code"),(0,o.yg)("p",null,(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-tsx",metastring:'title="src/pages/contacts/list.tsx"',title:'"src/pages/contacts/list.tsx"'},'import {\n  List,\n  TagField,\n  useTable,\n  EditButton,\n  DeleteButton,\n  useModalForm,\n  EmailField,\n} from "@refinedev/antd";\n\nimport { Table, Space } from "antd";\n\nimport { IContact } from "interfaces";\nimport { CreateContact } from "components/contacts";\n\nexport const ContactList: React.FC = () => {\n  const { tableProps } = useTable<IContact>({\n    meta: { populate: ["client"] },\n  });\n\n  const {\n    formProps: createContactFormProps,\n    modalProps,\n    show,\n  } = useModalForm({\n    resource: "contacts",\n    action: "create",\n    redirect: false,\n  });\n\n  return (\n    <>\n      <List\n        createButtonProps={{\n          onClick: () => {\n            show();\n          },\n        }}\n      >\n        <Table {...tableProps} rowKey="id">\n          <Table.Column dataIndex="id" title="ID" />\n          <Table.Column dataIndex="first_name" title="First Name" />\n          <Table.Column dataIndex="last_name" title="Last Name" />\n          <Table.Column dataIndex={["client", "name"]} title="Client Company" />\n          <Table.Column dataIndex="phone_number" title="Phone Number" />\n          <Table.Column\n            dataIndex="email"\n            title="Email"\n            render={(value: string) => <EmailField value={value} />}\n          />\n          <Table.Column\n            dataIndex="job"\n            title="Job"\n            render={(value: string) => (\n              <TagField color={"blue"} value={value} />\n            )}\n          />\n          <Table.Column<{ id: string }>\n            title="Actions"\n            dataIndex="actions"\n            render={(_, record) => (\n              <Space>\n                <EditButton hideText size="small" recordItemId={record.id} />\n                <DeleteButton hideText size="small" recordItemId={record.id} />\n              </Space>\n            )}\n          />\n        </Table>\n      </List>\n      <CreateContact\n        modalProps={modalProps}\n        formProps={createContactFormProps}\n        hideCompanySelect={false}\n      />\n    </>\n  );\n};\n')))),(0,o.yg)("p",null,"It is important to note that the ",(0,o.yg)("inlineCode",{parentName:"p"},"meta.populate")," property passed to ",(0,o.yg)("inlineCode",{parentName:"p"},"useTable()")," is used to include associated collections in a query:"),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-tsx"},'const { tableProps } = useTable<IContact>({\n  meta: { populate: ["client"] },\n});\n')),(0,o.yg)("p",null,"Here, we are getting the associated ",(0,o.yg)("inlineCode",{parentName:"p"},"clients")," data of each ",(0,o.yg)("inlineCode",{parentName:"p"},"contacts")," record."),(0,o.yg)("h3",{id:"create-action-for-contacts"},(0,o.yg)("inlineCode",{parentName:"h3"},"create")," Action for ",(0,o.yg)("inlineCode",{parentName:"h3"},"contacts")),(0,o.yg)("p",null,"To allow a ",(0,o.yg)("inlineCode",{parentName:"p"},"create")," action, once again, a ",(0,o.yg)("inlineCode",{parentName:"p"},"<CreateButton />")," is placed as a child of the ",(0,o.yg)("inlineCode",{parentName:"p"},"<List />")," component thanks to the ",(0,o.yg)("inlineCode",{parentName:"p"},"createButtonProps"),", which when clicked displays a modal with the ",(0,o.yg)("inlineCode",{parentName:"p"},"<CreateContact />")," component. The ",(0,o.yg)("inlineCode",{parentName:"p"},"<CreateContact />")," content are as below:"),(0,o.yg)("details",null,(0,o.yg)("summary",null,"Show Strapi data provider source code"),(0,o.yg)("p",null,(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-tsx",metastring:'title="src/components/contacts/CreateContact.tsx"',title:'"src/components/contacts/CreateContact.tsx"'},'import { useSelect } from "@refinedev/antd";\nimport { Form, Modal, Input, ModalProps, FormProps, Select, Grid } from "antd";\n\ntype CreateContactProps = {\n  modalProps: ModalProps;\n  formProps: FormProps;\n  hideCompanySelect?: boolean;\n};\n\nexport const CreateContact: React.FC<CreateContactProps> = ({\n  modalProps,\n  formProps,\n  hideCompanySelect = true,\n}) => {\n  const breakpoint = Grid.useBreakpoint();\n  const { selectProps } = useSelect({\n    resource: "clients",\n    optionValue: "id",\n    optionLabel: "name",\n\n    pagination: {\n      mode: "server",\n    },\n  });\n\n  return (\n    <Modal\n      {...modalProps}\n      title="Create Contact"\n      width={breakpoint.sm ? "600px" : "80%"}\n    >\n      <Form {...formProps} layout="vertical">\n        <Form.Item\n          label="First Name"\n          name="first_name"\n          rules={[\n            {\n              required: true,\n            },\n          ]}\n        >\n          <Input />\n        </Form.Item>\n        <Form.Item\n          label="Last Name"\n          name="last_name"\n          rules={[\n            {\n              required: true,\n            },\n          ]}\n        >\n          <Input />\n        </Form.Item>\n        <Form.Item\n          label="Client Company"\n          name="client"\n          hidden={hideCompanySelect}\n        >\n          <Select {...selectProps} />\n        </Form.Item>\n        <Form.Item label="Phone Number" name="phone_number">\n          <Input />\n        </Form.Item>\n        <Form.Item\n          label="Email"\n          name="email"\n          rules={[\n            {\n              required: true,\n              type: "email",\n            },\n          ]}\n        >\n          <Input />\n        </Form.Item>\n        <Form.Item label="Job" name="job">\n          <Input />\n        </Form.Item>\n      </Form>\n    </Modal>\n  );\n};\n')))),(0,o.yg)("p",null,"Again, the ",(0,o.yg)("inlineCode",{parentName:"p"},"<CreateContact />")," component is derived from a ",(0,o.yg)("inlineCode",{parentName:"p"},"<Modal />")," which is fed the ",(0,o.yg)("inlineCode",{parentName:"p"},"modalProps")," and ",(0,o.yg)("inlineCode",{parentName:"p"},"formProps")," received from ",(0,o.yg)("inlineCode",{parentName:"p"},"useModalForm()")," hook invoked inside ",(0,o.yg)("inlineCode",{parentName:"p"},"<ContactList />"),". This should look familiar from ",(0,o.yg)("a",{parentName:"p",href:"#list-view-for-companies"},"the ",(0,o.yg)("inlineCode",{parentName:"a"},"list")," views for companies section above"),"."),(0,o.yg)("h3",{id:"edit-action-for-contacts"},(0,o.yg)("inlineCode",{parentName:"h3"},"edit")," Action for ",(0,o.yg)("inlineCode",{parentName:"h3"},"contacts")),(0,o.yg)("p",null,(0,o.yg)("inlineCode",{parentName:"p"},"<ContactList />")," has an ",(0,o.yg)("inlineCode",{parentName:"p"},"<EditButton />")," which on click navigates to ",(0,o.yg)("inlineCode",{parentName:"p"},"/contacts/:id/edit")," path. We have specified the resource and routes definitions for this earlier."),(0,o.yg)("p",null,"The component ",(0,o.yg)("inlineCode",{parentName:"p"},"/contacts/:id/edit")," looks like this:"),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-tsx",metastring:'title="src/pages/contacts/edit.tsx"',title:'"src/pages/contacts/edit.tsx"'},'import { Edit, useForm, useSelect } from "@refinedev/antd";\nimport { Form, Select, Input } from "antd";\n\nimport { IContact } from "interfaces";\n\nexport const EditContact = () => {\n  const { formProps, saveButtonProps, queryResult } = useForm<IContact>({\n    meta: { populate: ["client"] },\n  });\n\n  const defaultClientCompany = queryResult?.data?.data;\n\n  const { selectProps } = useSelect({\n    resource: "clients",\n    defaultValue: defaultClientCompany?.client?.id,\n    optionValue: "id",\n    optionLabel: "name",\n\n    pagination: {\n      mode: "server",\n    },\n  });\n\n  return (\n    <Edit saveButtonProps={saveButtonProps}>\n      <Form {...formProps} layout="vertical" wrapperCol={{ md: 18, lg: 16 }}>\n        <Form.Item label="First Name" name="first_name">\n          <Input />\n        </Form.Item>\n        <Form.Item label="Last Name" name="last_name">\n          <Input />\n        </Form.Item>\n        <Form.Item label="Client Company" name={["client", "id"]}>\n          <Select {...selectProps} />\n        </Form.Item>\n        <Form.Item label="Phone Number" name="phone_number">\n          <Input />\n        </Form.Item>\n        <Form.Item label="Email" name="email">\n          <Input />\n        </Form.Item>\n        <Form.Item label="Job" name="job">\n          <Input />\n        </Form.Item>\n      </Form>\n    </Edit>\n  );\n};\n')),(0,o.yg)("p",null,"Here, we are using the ",(0,o.yg)("inlineCode",{parentName:"p"},"useForm()")," hook to grab ",(0,o.yg)("inlineCode",{parentName:"p"},"formProps")," to display existing data, and ",(0,o.yg)("inlineCode",{parentName:"p"},"saveButtonProps")," to perform a mutation. Notice we are also using the ",(0,o.yg)("inlineCode",{parentName:"p"},"useSelect()")," hook to fetch and display ",(0,o.yg)("inlineCode",{parentName:"p"},"selectProps")," inside the form."),(0,o.yg)("h3",{id:"delete-action-for-contacts"},(0,o.yg)("inlineCode",{parentName:"h3"},"delete")," Action for ",(0,o.yg)("inlineCode",{parentName:"h3"},"contacts")),(0,o.yg)("p",null,"The ",(0,o.yg)("inlineCode",{parentName:"p"},"delete")," action is implemented inside the ",(0,o.yg)("inlineCode",{parentName:"p"},"<DeleteButton />")," for each row in the displayed table:"),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-tsx",metastring:'title="src/pages/contacts/list.tsx"',title:'"src/pages/contacts/list.tsx"'},'<DeleteButton hideText size="small" recordItemId={record.id} />\n')),(0,o.yg)("p",null,"With these completed, we should now be able to create, list, edit and delete ",(0,o.yg)("inlineCode",{parentName:"p"},"contacts"),"."),(0,o.yg)("img",{style:{alignSelf:"center"},src:"https://refine.ams3.cdn.digitaloceanspaces.com/blog/2023-04-12-refine-invoicer-3/contacts.png",alt:"react invoice generator"}),(0,o.yg)("br",null),(0,o.yg)("h2",{id:"summary"},"Summary"),(0,o.yg)("p",null,"In this post, made use of ",(0,o.yg)("inlineCode",{parentName:"p"},"dataProvider")," methods and their corresponding hooks to implement CRUD operations on three resources, namely: ",(0,o.yg)("inlineCode",{parentName:"p"},"companies"),", ",(0,o.yg)("inlineCode",{parentName:"p"},"clients")," and ",(0,o.yg)("inlineCode",{parentName:"p"},"contacts"),"."),(0,o.yg)("p",null,"We leveraged some high level hooks such as ",(0,o.yg)("inlineCode",{parentName:"p"},"useSimpleList"),", ",(0,o.yg)("inlineCode",{parentName:"p"},"useModalForm()")," and ",(0,o.yg)("inlineCode",{parentName:"p"},"useDrawerForm()")," to fetch data and manage state in related components, which makes CRUD implementation very convenient. Examples of related components are ",(0,o.yg)("inlineCode",{parentName:"p"},"<List />"),", ",(0,o.yg)("inlineCode",{parentName:"p"},"<Modal />")," and ",(0,o.yg)("inlineCode",{parentName:"p"},"<Drawer />"),"."),(0,o.yg)("p",null,"We also implemented authentication and authorization on the ",(0,o.yg)("strong",{parentName:"p"},"Strapi")," backend side for a user we created on the ",(0,o.yg)("strong",{parentName:"p"},"Strapi")," app and the ",(0,o.yg)("strong",{parentName:"p"},"refine-Ant Design")," ",(0,o.yg)("inlineCode",{parentName:"p"},"<AuthPage />")," component."),(0,o.yg)("p",null,"In the next episode, we cover the views for two other resources: ",(0,o.yg)("inlineCode",{parentName:"p"},"missions")," and ",(0,o.yg)("inlineCode",{parentName:"p"},"invoices"),"."))}u.isMDXComponent=!0}}]);