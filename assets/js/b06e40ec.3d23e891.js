"use strict";(self.webpackChunkdocumentation=self.webpackChunkdocumentation||[]).push([[67954],{58860:(e,n,t)=>{t.d(n,{xA:()=>d,yg:()=>g});var i=t(37953);function o(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function a(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,i)}return t}function r(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?a(Object(t),!0).forEach((function(n){o(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):a(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function s(e,n){if(null==e)return{};var t,i,o=function(e,n){if(null==e)return{};var t,i,o={},a=Object.keys(e);for(i=0;i<a.length;i++)t=a[i],n.indexOf(t)>=0||(o[t]=e[t]);return o}(e,n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)t=a[i],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}var l=i.createContext({}),p=function(e){var n=i.useContext(l),t=n;return e&&(t="function"==typeof e?e(n):r(r({},n),e)),t},d=function(e){var n=p(e.components);return i.createElement(l.Provider,{value:n},e.children)},c="mdxType",m={inlineCode:"code",wrapper:function(e){var n=e.children;return i.createElement(i.Fragment,{},n)}},u=i.forwardRef((function(e,n){var t=e.components,o=e.mdxType,a=e.originalType,l=e.parentName,d=s(e,["components","mdxType","originalType","parentName"]),c=p(t),u=o,g=c["".concat(l,".").concat(u)]||c[u]||m[u]||a;return t?i.createElement(g,r(r({ref:n},d),{},{components:t})):i.createElement(g,r({ref:n},d))}));function g(e,n){var t=arguments,o=n&&n.mdxType;if("string"==typeof e||o){var a=t.length,r=new Array(a);r[0]=u;var s={};for(var l in n)hasOwnProperty.call(n,l)&&(s[l]=n[l]);s.originalType=e,s[c]="string"==typeof e?e:o,r[1]=s;for(var p=2;p<a;p++)r[p]=t[p];return i.createElement.apply(null,r)}return i.createElement.apply(null,t)}u.displayName="MDXCreateElement"},60990:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>l,default:()=>g,frontMatter:()=>s,metadata:()=>p,toc:()=>c});t(37953);var i=t(58860);function o(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function a(e,n){return n=null!=n?n:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):function(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,i)}return t}(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})),e}function r(e,n){if(null==e)return{};var t,i,o=function(e,n){if(null==e)return{};var t,i,o={},a=Object.keys(e);for(i=0;i<a.length;i++)t=a[i],n.indexOf(t)>=0||(o[t]=e[t]);return o}(e,n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)t=a[i],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}const s={title:"Creating Mission and Invoice Pages",description:"We add more CRUD views to the Pdf Invoice Generator app we have been building using Refine and Strapi last few days.",slug:"refine-react-invoice-generator-4",authors:"abdullah_numan",tags:["refine-week","refine","strapi","ant-design"],image:"https://refine.ams3.cdn.digitaloceanspaces.com/blog/2023-04-13-refine-invoicer-4/social.png",hide_table_of_contents:!1},l=void 0,p={permalink:"/blog/refine-react-invoice-generator-4",source:"@site/blog/2023-04-13-refine-invoicer-4.md",title:"Creating Mission and Invoice Pages",description:"We add more CRUD views to the Pdf Invoice Generator app we have been building using Refine and Strapi last few days.",date:"2023-04-13T00:00:00.000Z",formattedDate:"April 13, 2023",tags:[{label:"refine-week",permalink:"/blog/tags/refine-week"},{label:"refine",permalink:"/blog/tags/refine"},{label:"strapi",permalink:"/blog/tags/strapi"},{label:"ant-design",permalink:"/blog/tags/ant-design"}],readingTime:17.78,hasTruncateMarker:!1,authors:[{name:"Abdullah Numan",title:"Fullstack Developer",url:"https://github.com/anewman15/",imageURL:"https://github.com/anewman15.png",key:"abdullah_numan"}],frontMatter:{title:"Creating Mission and Invoice Pages",description:"We add more CRUD views to the Pdf Invoice Generator app we have been building using Refine and Strapi last few days.",slug:"refine-react-invoice-generator-4",authors:"abdullah_numan",tags:["refine-week","refine","strapi","ant-design"],image:"https://refine.ams3.cdn.digitaloceanspaces.com/blog/2023-04-13-refine-invoicer-4/social.png",hide_table_of_contents:!1},prevItem:{title:"Adding PDF Renderer",permalink:"/blog/refine-react-invoice-generator-5"},nextItem:{title:"Adding CRUD Pages",permalink:"/blog/refine-react-invoice-generator-3"},relatedPosts:[{title:"OTP Authentication with Supabase and Twilio in React",description:"We'll implement OTP(SMS) authorization using Twilio and Supabase in React app.",permalink:"/blog/supabase-twilio-otp-authentication-in-react",formattedDate:"September 22, 2022",authors:[{name:"Vijit Ail",title:"Software Engineer",url:"https://github.com/vijitail",imageURL:"https://github.com/vijitail.png",key:"vijit_ail"}],readingTime:14.17,date:"2022-09-22T00:00:00.000Z"},{title:"Adding PDF Renderer",description:"We are going to add PDF renderer to our PDF Invoice Generator app that we have been building last few days. This is also where we summarize our accomplishments and wrap up the series.",permalink:"/blog/refine-react-invoice-generator-5",formattedDate:"April 14, 2023",authors:[{name:"Abdullah Numan",title:"Fullstack Developer",url:"https://github.com/anewman15/",imageURL:"https://github.com/anewman15.png",key:"abdullah_numan"}],readingTime:8.625,date:"2023-04-14T00:00:00.000Z"},{title:"How to Build a React Admin Panel with Mantine and Strapi",description:"We'll be building a simple React Admin Panel with Refine and Mantine using Strapi as a backend service.",permalink:"/blog/react-admin-panel",formattedDate:"February 23, 2023",authors:[{name:"Joseph Mawa",title:"Web Developer",url:"https://github.com/nibble0101",imageURL:"/img/generic-profile.png",key:"joseph_mawa"}],readingTime:23.095,date:"2023-02-23T00:00:00.000Z"}],authorPosts:[{title:"Audit Log With Refine",description:"We'll apply Refine's built-in audit logging functionality",permalink:"/blog/refine-pixels-7",formattedDate:"February 20, 2023",authors:[{name:"Abdullah Numan",title:"Fullstack Developer",url:"https://github.com/anewman15/",imageURL:"https://github.com/anewman15.png",key:"abdullah_numan"}],readingTime:15.515,date:"2023-02-20T00:00:00.000Z"},{title:"Using Heroicons with TailwindCSS",description:"In this post, we see how to use Heroicons with TailwindCSS.",permalink:"/blog/heroicons-with-tailwind",formattedDate:"August 19, 2024",authors:[{name:"Abdullah Numan",title:"Fullstack Developer",url:"https://github.com/anewman15/",imageURL:"https://github.com/anewman15.png",key:"abdullah_numan"}],readingTime:14.115,date:"2024-08-19T00:00:00.000Z"},{title:"Setting Up the Client App",description:"We'll initialize our Pixels app using Refine and get familiar with the boilerplate code to be created with the create refine-app CLI tool.",permalink:"/blog/refine-pixels-2",formattedDate:"February 15, 2023",authors:[{name:"Abdullah Numan",title:"Fullstack Developer",url:"https://github.com/anewman15/",imageURL:"https://github.com/anewman15.png",key:"abdullah_numan"}],readingTime:15.07,date:"2023-02-15T00:00:00.000Z"}]},d={authorsImageUrls:[void 0]},c=[{value:"RefineWeek ft. Strapi series",id:"refineweek-ft-strapi-series",level:3},{value:"Overview",id:"overview",level:2},{value:"Strapi Collections for <code>missions</code> and <code>invoices</code>",id:"strapi-collections-for-missions-and-invoices",level:2},{value:"Strapi <code>missions</code> Collection",id:"strapi-missions-collection",level:3},{value:"Strapi <code>invoices</code> Collection",id:"strapi-invoices-collection",level:3},{value:"Strapi Authorization for <code>Authenticated</code> Role",id:"strapi-authorization-for-authenticated-role",level:3},{value:"Adding <code>resources</code> and Routes for <code>missions</code> and <code>invoices</code>",id:"adding-resources-and-routes-for-missions-and-invoices",level:2},{value:"Adding Views for <code>missions</code>",id:"adding-views-for-missions",level:2},{value:"Refine <code>list</code> View for <code>missions</code>",id:"refine-list-view-for-missions",level:3},{value:"Refine <code>create</code> View for <code>missions</code>",id:"refine-create-view-for-missions",level:3},{value:"Refine <code>edit</code> View for <code>missions</code>",id:"refine-edit-view-for-missions",level:3},{value:"Adding Views for <code>invoices</code>",id:"adding-views-for-invoices",level:2},{value:"Refine <code>list</code> View for <code>invoices</code>",id:"refine-list-view-for-invoices",level:3},{value:"Refine <code>create</code> View for <code>invoices</code>",id:"refine-create-view-for-invoices",level:3},{value:"Refine <code>edit</code> Views for <code>invoices</code>",id:"refine-edit-views-for-invoices",level:3},{value:"Low Level Inspection",id:"low-level-inspection",level:2},{value:"refine-Ant Design <code>useTable()</code> Hook",id:"refine-ant-design-usetable-hook",level:3},{value:"refine-Ant Design <code>useSelect()</code> Hook",id:"refine-ant-design-useselect-hook",level:3},{value:"refine-Ant Design <code>&lt;DeleteButton /&gt;</code>",id:"refine-ant-design-deletebutton-",level:3},{value:"Summary",id:"summary",level:2}],m={toc:c},u="wrapper";function g(e){var{components:n}=e,t=r(e,["components"]);return(0,i.yg)(u,a(function(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},i=Object.keys(t);"function"==typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),i.forEach((function(n){o(e,n,t[n])}))}return e}({},m,t),{components:n,mdxType:"MDXLayout"}),(0,i.yg)("p",null,"In this post, we add more CRUD views to the ",(0,i.yg)("strong",{parentName:"p"},"Pdf Invoice Generator")," app we have been building using ",(0,i.yg)("strong",{parentName:"p"},"Refine")," last few days. The resources we cover in this episode are: ",(0,i.yg)("inlineCode",{parentName:"p"},"missions")," and ",(0,i.yg)("inlineCode",{parentName:"p"},"invoices"),". We mainly continue leveraging ",(0,i.yg)("inlineCode",{parentName:"p"},"dataProvider")," methods and adding to the ",(0,i.yg)("inlineCode",{parentName:"p"},"resources")," prop as well as associated route definitions."),(0,i.yg)("p",null,"We are on Day Four of ",(0,i.yg)("a",{parentName:"p",href:"https://refine.dev/week-of-refine-strapi/"},(0,i.yg)("strong",{parentName:"a"},"#RefineWeek"))," series which is a five-part tutorial that aims to help developers learn the ins-and-outs of ",(0,i.yg)("strong",{parentName:"p"},"Refine"),"'s powerful capabilities and get going with ",(0,i.yg)("strong",{parentName:"p"},"Refine")," within a week."),(0,i.yg)("h3",{id:"refineweek-ft-strapi-series"},"RefineWeek ft. Strapi series"),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},"Day 1 - ",(0,i.yg)("a",{parentName:"li",href:"https://refine.dev/blog/refine-react-invoice-generator-1/"},"Pilot & Refine architecture")),(0,i.yg)("li",{parentName:"ul"},"Day 2 - ",(0,i.yg)("a",{parentName:"li",href:"https://refine.dev/blog/refine-react-invoice-generator-2/"},"Setting Up the Invoicer App")),(0,i.yg)("li",{parentName:"ul"},"Day 3 - ",(0,i.yg)("a",{parentName:"li",href:"https://refine.dev/blog/refine-react-invoice-generator-3/"},"Adding CRUD Actions & Views"))),(0,i.yg)("h2",{id:"overview"},"Overview"),(0,i.yg)("p",null,"On ",(0,i.yg)("a",{parentName:"p",href:"https://refine.dev/blog/refine-react-invoice-generator-3/"},"Day 3"),", we implemented CRUD actions for ",(0,i.yg)("inlineCode",{parentName:"p"},"companies"),", ",(0,i.yg)("inlineCode",{parentName:"p"},"clients")," and ",(0,i.yg)("inlineCode",{parentName:"p"},"contacts"),". We saw that core data hooks such as ",(0,i.yg)("inlineCode",{parentName:"p"},"useCreate()")," are invoked to access corresponding ",(0,i.yg)("inlineCode",{parentName:"p"},"dataProvider")," methods (for example, ",(0,i.yg)("inlineCode",{parentName:"p"},"dataProvider.create"),"). And more sophisticated hooks like ",(0,i.yg)("inlineCode",{parentName:"p"},"useSimpleList()")," are built on top of low level hooks like ",(0,i.yg)("inlineCode",{parentName:"p"},"useList()"),"."),(0,i.yg)("p",null,"We have used some other higher level hooks as well, like ",(0,i.yg)("inlineCode",{parentName:"p"},"useModalForm()"),", ",(0,i.yg)("inlineCode",{parentName:"p"},"useDrawerForm()")," and ",(0,i.yg)("inlineCode",{parentName:"p"},"useTable()")," - all of which combine data fetching and UI presentation with ",(0,i.yg)("strong",{parentName:"p"},"Ant Design")," components and give us compact and convenient hooks and components to work with."),(0,i.yg)("p",null,"We covered ",(0,i.yg)("inlineCode",{parentName:"p"},"useTable()")," on ",(0,i.yg)("a",{parentName:"p",href:"https://refine.dev/blog/refine-react-invoice-generator-3/"},"Day 3"),", and in this post we also use it to list ",(0,i.yg)("inlineCode",{parentName:"p"},"missions")," and ",(0,i.yg)("inlineCode",{parentName:"p"},"invoices"),". So, we will be inspecting some low level code to examine how ",(0,i.yg)("inlineCode",{parentName:"p"},"useTable()")," implements data fetching and UI presentation under the hood. We are going to do the same for ",(0,i.yg)("inlineCode",{parentName:"p"},"useSelect()"),". We also spend some time digging deep into the ",(0,i.yg)("inlineCode",{parentName:"p"},"<DeleteButton />")," component in order to witness how it implements the ",(0,i.yg)("inlineCode",{parentName:"p"},"dataProvider.delete")," method."),(0,i.yg)("p",null,"But before we move into writing code, we have to define the collections for ",(0,i.yg)("inlineCode",{parentName:"p"},"missions")," and ",(0,i.yg)("inlineCode",{parentName:"p"},"invoices")," in our ",(0,i.yg)("a",{parentName:"p",href:"https://strapi.io/"},(0,i.yg)("strong",{parentName:"a"},"Strapi"))," app. Let's start with them."),(0,i.yg)("h2",{id:"strapi-collections-for-missions-and-invoices"},"Strapi Collections for ",(0,i.yg)("inlineCode",{parentName:"h2"},"missions")," and ",(0,i.yg)("inlineCode",{parentName:"h2"},"invoices")),(0,i.yg)("p",null,"Let's revisit the ERD for our ",(0,i.yg)("strong",{parentName:"p"},"Pdf Invoice Generator")," app:"),(0,i.yg)("img",{style:{alignSelf:"center"},src:"https://refine.ams3.cdn.digitaloceanspaces.com/blog/2023-04-13-refine-invoicer-4/database.png",alt:"react invoice generator"}),(0,i.yg)("br",null),(0,i.yg)("p",null,"We can see from the diagram that ",(0,i.yg)("inlineCode",{parentName:"p"},"invoices")," have an open ",(0,i.yg)("inlineCode",{parentName:"p"},"one-to-many")," relation with ",(0,i.yg)("inlineCode",{parentName:"p"},"missions")," with at least one mission mandatory for an invoice. On the other hand, ",(0,i.yg)("inlineCode",{parentName:"p"},"contacts")," should have a ",(0,i.yg)("inlineCode",{parentName:"p"},"one-to-many")," optional relation with ",(0,i.yg)("inlineCode",{parentName:"p"},"invoices"),"."),(0,i.yg)("p",null,"With this in mind, let's go ahead and create collections in our ",(0,i.yg)("strong",{parentName:"p"},"Strapi")," app."),(0,i.yg)("h3",{id:"strapi-missions-collection"},"Strapi ",(0,i.yg)("inlineCode",{parentName:"h3"},"missions")," Collection"),(0,i.yg)("p",null,"We should use the ",(0,i.yg)("inlineCode",{parentName:"p"},"Content-Type Builder")," again to define these collections. The ",(0,i.yg)("inlineCode",{parentName:"p"},"missions")," collection should look like this:"),(0,i.yg)("img",{src:"https://refine.ams3.cdn.digitaloceanspaces.com/blog/2023-04-13-refine-invoicer-4/mission_collection.png",alt:"react crud app airtable"}),(0,i.yg)("br",null),(0,i.yg)("h3",{id:"strapi-invoices-collection"},"Strapi ",(0,i.yg)("inlineCode",{parentName:"h3"},"invoices")," Collection"),(0,i.yg)("p",null,"The ",(0,i.yg)("inlineCode",{parentName:"p"},"invoices")," collection should look as below:"),(0,i.yg)("img",{src:"https://refine.ams3.cdn.digitaloceanspaces.com/blog/2023-04-13-refine-invoicer-4/invoice_collection.png",alt:"react crud app airtable"}),(0,i.yg)("br",null),(0,i.yg)("p",null,(0,i.yg)("inlineCode",{parentName:"p"},"invoices")," has a ",(0,i.yg)("inlineCode",{parentName:"p"},"has one")," association with ",(0,i.yg)("inlineCode",{parentName:"p"},"companies"),":"),(0,i.yg)("img",{src:"https://refine.ams3.cdn.digitaloceanspaces.com/blog/2023-04-13-refine-invoicer-4/invoice_company.png",alt:"react crud app airtable"}),(0,i.yg)("br",null),(0,i.yg)("p",null,"It also has the same ",(0,i.yg)("inlineCode",{parentName:"p"},"has one")," association with ",(0,i.yg)("inlineCode",{parentName:"p"},"contacts")),(0,i.yg)("img",{src:"https://refine.ams3.cdn.digitaloceanspaces.com/blog/2023-04-13-refine-invoicer-4/invoice_hasone.png",alt:"react crud app airtable"}),(0,i.yg)("br",null),(0,i.yg)("p",null,"It also maintains a ",(0,i.yg)("inlineCode",{parentName:"p"},"has many")," association with ",(0,i.yg)("inlineCode",{parentName:"p"},"missions"),":"),(0,i.yg)("img",{src:"https://refine.ams3.cdn.digitaloceanspaces.com/blog/2023-04-13-refine-invoicer-4/invoice_hasmany.png",alt:"react crud app airtable"}),(0,i.yg)("br",null),(0,i.yg)("p",null,"With the collections completed, we should now authorize ",(0,i.yg)("inlineCode",{parentName:"p"},"Authenticated")," users to perform CRUD operations on them."),(0,i.yg)("h3",{id:"strapi-authorization-for-authenticated-role"},"Strapi Authorization for ",(0,i.yg)("inlineCode",{parentName:"h3"},"Authenticated")," Role"),(0,i.yg)("p",null,"Like we did before with the ",(0,i.yg)("inlineCode",{parentName:"p"},"companies"),", ",(0,i.yg)("inlineCode",{parentName:"p"},"clients")," and ",(0,i.yg)("inlineCode",{parentName:"p"},"contacts")," collections, we should set permissions for our ",(0,i.yg)("inlineCode",{parentName:"p"},"Authenticated")," users to access and perform queries and mutations on the ",(0,i.yg)("inlineCode",{parentName:"p"},"/missions")," and ",(0,i.yg)("inlineCode",{parentName:"p"},"/invoices")," endpoints."),(0,i.yg)("p",null,"We can do this from the following path in our ",(0,i.yg)("strong",{parentName:"p"},"Strapi")," app: ",(0,i.yg)("inlineCode",{parentName:"p"},"/admin/settings/users-permissions/roles/1")),(0,i.yg)("img",{src:"https://refine.ams3.cdn.digitaloceanspaces.com/blog/2023-04-13-refine-invoicer-4/authenticated.png",alt:"react crud app airtable"}),(0,i.yg)("br",null),(0,i.yg)("p",null,"We need to set permissions for both ",(0,i.yg)("inlineCode",{parentName:"p"},"missions")," and ",(0,i.yg)("inlineCode",{parentName:"p"},"invoices"),"."),(0,i.yg)("p",null,"With these done, now we can head back to our ",(0,i.yg)("strong",{parentName:"p"},"Refine")," app and add resources and routes for these entities."),(0,i.yg)("h2",{id:"adding-resources-and-routes-for-missions-and-invoices"},"Adding ",(0,i.yg)("inlineCode",{parentName:"h2"},"resources")," and Routes for ",(0,i.yg)("inlineCode",{parentName:"h2"},"missions")," and ",(0,i.yg)("inlineCode",{parentName:"h2"},"invoices")),(0,i.yg)("p",null,"Back in our ",(0,i.yg)("inlineCode",{parentName:"p"},"App.tsx"),", let's quickly add the resource objects and route definitions:"),(0,i.yg)("details",null,(0,i.yg)("summary",null,"Show App.tsx code"),(0,i.yg)("p",null,(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-tsx",metastring:'title="App.tsx"',title:'"App.tsx"'},'import { Authenticated, GitHubBanner, Refine } from "@refinedev/core";\nimport { RefineKbar, RefineKbarProvider } from "@refinedev/kbar";\n\nimport {\n  AuthPage,\n  ErrorComponent,\n  ThemedLayout,\n  useNotificationProvider,\n  ThemedTitle,\n} from "@refinedev/antd";\nimport "@refinedev/antd/dist/reset.css";\nimport * as Icons from "@ant-design/icons";\n\nconst {\n  UserAddOutlined,\n  TeamOutlined,\n  InfoCircleOutlined,\n  SlidersOutlined,\n  FileAddOutlined,\n} = Icons;\n\nimport routerBindings, {\n  CatchAllNavigate,\n  NavigateToResource,\n  UnsavedChangesNotifier,\n} from "@refinedev/react-router";\nimport { DataProvider } from "@refinedev/strapi-v4";\nimport { BrowserRouter, Outlet, Route, Routes } from "react-router-dom";\nimport { authProvider, axiosInstance } from "./authProvider";\nimport { Header } from "./components/header";\nimport { API_URL } from "./constants";\nimport { ColorModeContextProvider } from "./contexts/color-mode";\nimport { CompanyList } from "pages/companies";\nimport { ClientList } from "pages/clients";\nimport { ContactList, EditContact } from "pages/contacts";\nimport { MissionList } from "pages/missions";\nimport { CreateInvoice, EditInvoice, InvoiceList } from "pages/invoices";\n\nfunction App() {\n  return (\n    <BrowserRouter>\n      <GitHubBanner />\n      <RefineKbarProvider>\n        <ColorModeContextProvider>\n          <Refine\n            resources={[\n              {\n                name: "companies",\n                list: "/companies",\n                icon: <InfoCircleOutlined />,\n              },\n              {\n                name: "clients",\n                list: "/clients",\n                icon: <TeamOutlined />,\n              },\n              {\n                name: "contacts",\n                list: "/contacts",\n                edit: "/contacts/:id/edit",\n                icon: <UserAddOutlined />,\n              },\n              {\n                name: "missions",\n                list: "/missions",\n                icon: <SlidersOutlined />,\n              },\n              {\n                name: "invoices",\n                list: "/invoices",\n                create: "/invoices/create",\n                edit: "invoices/:id/edit",\n                icon: <FileAddOutlined />,\n              },\n            ]}\n            authProvider={authProvider}\n            dataProvider={DataProvider(API_URL + `/api`, axiosInstance)}\n            notificationProvider={useNotificationProvider}\n            routerProvider={routerBindings}\n            options={{\n              syncWithLocation: true,\n              warnWhenUnsavedChanges: true,\n            }}\n          >\n            <Routes>\n              <Route\n                element={\n                  <Authenticated fallback={<CatchAllNavigate to="/login" />}>\n                    <ThemedLayout\n                      Header={Header}\n                      Title={({ collapsed }) => (\n                        <ThemedTitleV2 collapsed={collapsed} text="Invoicer" />\n                      )}\n                    >\n                      <Outlet />\n                    </ThemedLayout>\n                  </Authenticated>\n                }\n              >\n                <Route\n                  index\n                  element={<NavigateToResource resource="companies" />}\n                />\n                <Route path="/companies">\n                  <Route index element={<CompanyList />} />\n                </Route>\n                <Route path="/clients">\n                  <Route index element={<ClientList />} />\n                </Route>\n                <Route path="/contacts">\n                  <Route index element={<ContactList />} />\n                  <Route path="/contacts/:id/edit" element={<EditContact />} />\n                </Route>\n                <Route path="/missions">\n                  <Route index element={<MissionList />} />\n                </Route>\n                <Route path="/invoices">\n                  <Route index element={<InvoiceList />} />\n                  <Route path="/invoices/create" element={<CreateInvoice />} />\n                  <Route path="/invoices/:id/edit" element={<EditInvoice />} />\n                </Route>\n              </Route>\n              <Route\n                element={\n                  <Authenticated fallback={<Outlet />}>\n                    <NavigateToResource />\n                  </Authenticated>\n                }\n              >\n                <Route\n                  path="/login"\n                  element={\n                    <AuthPage\n                      type="login"\n                      title={<ThemedTitleV2 collapsed text="Invoicer" />}\n                      formProps={{\n                        initialValues: {\n                          email: "demo@refine.dev",\n                          password: "demodemo",\n                        },\n                      }}\n                    />\n                  }\n                />\n              </Route>\n              <Route\n                element={\n                  <Authenticated>\n                    <ThemedLayout\n                      Header={Header}\n                      Title={({ collapsed }) => (\n                        <ThemedTitleV2 collapsed={collapsed} text="Invoicer" />\n                      )}\n                    >\n                      <Outlet />\n                    </ThemedLayout>\n                  </Authenticated>\n                }\n              >\n                <Route path="*" element={<ErrorComponent />} />\n              </Route>\n            </Routes>\n\n            <RefineKbar />\n            <UnsavedChangesNotifier />\n          </Refine>\n        </ColorModeContextProvider>\n      </RefineKbarProvider>\n    </BrowserRouter>\n  );\n}\n\nexport default App;\n')))),(0,i.yg)("h2",{id:"adding-views-for-missions"},"Adding Views for ",(0,i.yg)("inlineCode",{parentName:"h2"},"missions")),(0,i.yg)("p",null,"We only have a ",(0,i.yg)("inlineCode",{parentName:"p"},"list")," route for ",(0,i.yg)("inlineCode",{parentName:"p"},"missions")," so let's have a look at what the ",(0,i.yg)("inlineCode",{parentName:"p"},"<MissionList />")," component entails."),(0,i.yg)("h3",{id:"refine-list-view-for-missions"},"Refine ",(0,i.yg)("inlineCode",{parentName:"h3"},"list")," View for ",(0,i.yg)("inlineCode",{parentName:"h3"},"missions")),(0,i.yg)("p",null,"The ",(0,i.yg)("inlineCode",{parentName:"p"},"<MissionList />")," component looks like this:"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-tsx",metastring:'title="src/pages/missions/list.tsx"',title:'"src/pages/missions/list.tsx"'},'import {\n  List,\n  useTable,\n  TagField,\n  useModalForm,\n  EditButton,\n} from "@refinedev/antd";\nimport { Table } from "antd";\n\nimport { IMission } from "interfaces";\nimport { CreateMission, EditMission } from "components/missions";\n\nexport const MissionList: React.FC = () => {\n  const { tableProps } = useTable<IMission>();\n\n  const { formProps, modalProps, show } = useModalForm({\n    resource: "missions",\n    action: "create",\n  });\n\n  const {\n    formProps: editFormProps,\n    modalProps: editModalProps,\n    show: editShow,\n  } = useModalForm({\n    resource: "missions",\n    action: "edit",\n  });\n\n  return (\n    <>\n      <List\n        createButtonProps={{\n          onClick: () => {\n            show();\n          },\n        }}\n      >\n        <Table {...tableProps}>\n          <Table.Column dataIndex="id" title="ID" />\n          <Table.Column dataIndex="mission" title="Name" />\n          <Table.Column\n            dataIndex="mission_description"\n            title="Mission Description"\n          />\n          <Table.Column dataIndex="day" title="Day(s)" />\n          <Table.Column\n            dataIndex="daily_rate"\n            title="Daily Rate"\n            render={(value) => <TagField value={value} color="red" />}\n          />\n          <Table.Column<IMission>\n            title="Total"\n            render={(_, record) => {\n              return (\n                <TagField\n                  value={`${record?.daily_rate * record?.day} $`}\n                  color="green"\n                />\n              );\n            }}\n          />\n          <Table.Column<IMission>\n            title="Actions"\n            dataIndex="actions"\n            key="actions"\n            render={(_value, record) => (\n              <EditButton\n                hideText\n                size="small"\n                recordItemId={record?.id}\n                onClick={() => editShow(record?.id)}\n              />\n            )}\n          />\n        </Table>\n      </List>\n      <CreateMission modalProps={modalProps} formProps={formProps} />\n      <EditMission modalProps={editModalProps} formProps={editFormProps} />\n    </>\n  );\n};\n')),(0,i.yg)("p",null,"The ",(0,i.yg)("inlineCode",{parentName:"p"},"useTable()"),"and ",(0,i.yg)("inlineCode",{parentName:"p"},"useModalForm()")," hooks are already familiar to us, as we have used them on ",(0,i.yg)("a",{parentName:"p",href:"https://refine.dev/blog/refine-react-invoice-generator-3/"},"Day 3"),". In short, ",(0,i.yg)("strong",{parentName:"p"},"refine-Ant Design"),"'s ",(0,i.yg)("inlineCode",{parentName:"p"},"useTable()")," hook produces for us a set of props inside ",(0,i.yg)("inlineCode",{parentName:"p"},"tableProps")," which is tailored to match the props accepted by ",(0,i.yg)("strong",{parentName:"p"},"Ant Design"),"'s ",(0,i.yg)("inlineCode",{parentName:"p"},"<Table />")," component. Similarly, we are picking the ",(0,i.yg)("inlineCode",{parentName:"p"},"formProps")," object exposed by ",(0,i.yg)("inlineCode",{parentName:"p"},"useModalForm()")," hook to be passed to the ",(0,i.yg)("inlineCode",{parentName:"p"},"<Form />")," component, and also the ",(0,i.yg)("inlineCode",{parentName:"p"},"modalProps")," to match the props accepted by ",(0,i.yg)("inlineCode",{parentName:"p"},"<Modal />")," component."),(0,i.yg)("p",null,"Towards the end of this post, we dig into some of these hooks' source code and try to make sense of how ",(0,i.yg)("strong",{parentName:"p"},"Refine")," handles all these for us under the hood."),(0,i.yg)("h3",{id:"refine-create-view-for-missions"},"Refine ",(0,i.yg)("inlineCode",{parentName:"h3"},"create")," View for ",(0,i.yg)("inlineCode",{parentName:"h3"},"missions")),(0,i.yg)("p",null,"This is also similar to what we did on ",(0,i.yg)("a",{parentName:"p",href:"https://refine.dev/blog/refine-react-invoice-generator-3/"},"Day 3"),". The ",(0,i.yg)("inlineCode",{parentName:"p"},"create")," action for ",(0,i.yg)("inlineCode",{parentName:"p"},"missions")," resource is performed from a ",(0,i.yg)("inlineCode",{parentName:"p"},"<Form />")," inside the ",(0,i.yg)("inlineCode",{parentName:"p"},"<CreateMission />")," view which is basically built on top of a ",(0,i.yg)("inlineCode",{parentName:"p"},"<Modal />")," component."),(0,i.yg)("p",null,"Thanks to the ",(0,i.yg)("inlineCode",{parentName:"p"},"createButtonProps")," of the ",(0,i.yg)("inlineCode",{parentName:"p"},"<List />")," component, the modal is accessible upon click on a ",(0,i.yg)("inlineCode",{parentName:"p"},"<CreateButton />"),"."),(0,i.yg)("p",null,"The ",(0,i.yg)("inlineCode",{parentName:"p"},"<CreateMission />")," component which accepts and relays ",(0,i.yg)("inlineCode",{parentName:"p"},"formProps")," to ",(0,i.yg)("inlineCode",{parentName:"p"},"<Form />")," and ",(0,i.yg)("inlineCode",{parentName:"p"},"modalProps")," to the ",(0,i.yg)("inlineCode",{parentName:"p"},"<Modal />")," component looks like this:"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-tsx",metastring:'title="src/components/mission/create.tsx"',title:'"src/components/mission/create.tsx"'},'import { Form, Input, ModalProps, FormProps, Modal, InputNumber } from "antd";\n\ntype CreateMissionProps = {\n  modalProps: ModalProps;\n  formProps: FormProps;\n};\n\nexport const CreateMission: React.FC<CreateMissionProps> = ({\n  modalProps,\n  formProps,\n}) => {\n  return (\n    <Modal {...modalProps} title="Create Contact">\n      <Form {...formProps} layout="vertical">\n        <Form.Item\n          label="Title"\n          name="mission"\n          rules={[\n            {\n              required: true,\n            },\n          ]}\n        >\n          <Input />\n        </Form.Item>\n        <Form.Item label="Description" name="mission_description">\n          <Input />\n        </Form.Item>\n        <Form.Item label="Day(s)" name="day">\n          <InputNumber defaultValue={1} />\n        </Form.Item>\n        <Form.Item label="Daily Rate" name="daily_rate">\n          <InputNumber defaultValue={1} />\n        </Form.Item>\n      </Form>\n    </Modal>\n  );\n};\n')),(0,i.yg)("h3",{id:"refine-edit-view-for-missions"},"Refine ",(0,i.yg)("inlineCode",{parentName:"h3"},"edit")," View for ",(0,i.yg)("inlineCode",{parentName:"h3"},"missions")),(0,i.yg)("p",null,"The ",(0,i.yg)("inlineCode",{parentName:"p"},"edit")," view is also similar to the ",(0,i.yg)("inlineCode",{parentName:"p"},"create")," view. The ",(0,i.yg)("inlineCode",{parentName:"p"},"<EditMission />")," component looks like this:"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-tsx",metastring:'title="src/components/mission/edit.tsx"',title:'"src/components/mission/edit.tsx"'},'import { Form, Input, ModalProps, FormProps, Modal, InputNumber } from "antd";\n\ntype EditMissionProps = {\n  modalProps: ModalProps;\n  formProps: FormProps;\n};\n\nexport const EditMission: React.FC<EditMissionProps> = ({\n  modalProps,\n  formProps,\n}) => {\n  return (\n    <Modal {...modalProps} title="Create Contact">\n      <Form {...formProps} layout="vertical">\n        <Form.Item\n          label="Title"\n          name="mission"\n          rules={[\n            {\n              required: true,\n            },\n          ]}\n        >\n          <Input />\n        </Form.Item>\n        <Form.Item label="Description" name="mission_description">\n          <Input />\n        </Form.Item>\n        <Form.Item label="Day(s)" name="day">\n          <InputNumber defaultValue={1} />\n        </Form.Item>\n        <Form.Item label="Daily Rate" name="daily_rate">\n          <InputNumber defaultValue={1} />\n        </Form.Item>\n      </Form>\n    </Modal>\n  );\n};\n')),(0,i.yg)("p",null,"It's render is triggered by a click on the ",(0,i.yg)("inlineCode",{parentName:"p"},"<EditButton />")," placed inside a ",(0,i.yg)("inlineCode",{parentName:"p"},"<Table.Column />")," element in the ",(0,i.yg)("inlineCode",{parentName:"p"},"<MissionList />")," component."),(0,i.yg)("p",null,"Ok. With these views completed, we should be able to create, list and show ",(0,i.yg)("inlineCode",{parentName:"p"},"missions")," records from our app."),(0,i.yg)("img",{style:{alignSelf:"center"},src:"https://refine.ams3.cdn.digitaloceanspaces.com/blog/2023-04-13-refine-invoicer-4/edit_view.png",alt:"react invoice generator"}),(0,i.yg)("br",null),(0,i.yg)("h2",{id:"adding-views-for-invoices"},"Adding Views for ",(0,i.yg)("inlineCode",{parentName:"h2"},"invoices")),(0,i.yg)("p",null,"For the ",(0,i.yg)("inlineCode",{parentName:"p"},"invoices")," resource, we have three routes and each path has its own view. Let's start with again with the ",(0,i.yg)("inlineCode",{parentName:"p"},"list"),"."),(0,i.yg)("h3",{id:"refine-list-view-for-invoices"},"Refine ",(0,i.yg)("inlineCode",{parentName:"h3"},"list")," View for ",(0,i.yg)("inlineCode",{parentName:"h3"},"invoices")),(0,i.yg)("p",null,"The ",(0,i.yg)("inlineCode",{parentName:"p"},"<InvoiceList />")," rendered at ",(0,i.yg)("inlineCode",{parentName:"p"},"/invoices")," looks like this:"),(0,i.yg)("details",null,(0,i.yg)("summary",null,"Show InvoiceList code "),(0,i.yg)("p",null,(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-tsx",metastring:'title="src/pages/invoices/list.tsx"',title:'"src/pages/invoices/list.tsx"'},'import { useState } from "react";\nimport { useModal } from "@refinedev/core";\nimport {\n  List,\n  useTable,\n  DateField,\n  TagField,\n  EmailField,\n  DeleteButton,\n  EditButton,\n} from "@refinedev/antd";\n\n// It is recommended to use explicit import as seen below to reduce bundle size.\n// import { IconName } from "@ant-design/icons";\nimport * as Icons from "@ant-design/icons";\n\nimport { Table, Space, Button, Modal } from "antd";\n\nimport { IInvoice, IMission } from "interfaces";\n// import { PdfLayout } from "components/pdf";\n\nconst { FilePdfOutlined } = Icons;\n\nexport const InvoiceList: React.FC = () => {\n  const [record, setRecord] = useState<IInvoice>();\n\n  const { tableProps } = useTable<IInvoice>({\n    meta: {\n      populate: {\n        contact: { populate: ["client"] },\n        company: { populate: ["logo"] },\n        missions: "*",\n      },\n    },\n  });\n\n  const { show, visible, close } = useModal();\n\n  return (\n    <>\n      <List>\n        <Table {...tableProps}>\n          <Table.Column dataIndex="id" title="ID" />\n          <Table.Column<IInvoice>\n            dataIndex="name"\n            title="Invoice Name"\n            render={(_, record) => {\n              return `Invoice_#${record.id}${record?.name}`;\n            }}\n          />\n          <Table.Column<IInvoice>\n            dataIndex="date"\n            title="Invoice Date"\n            render={(value) => <DateField format="LL" value={value} />}\n          />\n          <Table.Column dataIndex={["company", "name"]} title="Company" />\n          <Table.Column\n            dataIndex={"missions"}\n            title="Missions"\n            render={(value) => {\n              return value.map((item: IMission) => {\n                return (\n                  <TagField key={item?.id} color="blue" value={item?.mission} />\n                );\n              });\n            }}\n          />\n          <Table.Column\n            dataIndex="discount"\n            title="Discount(%)"\n            render={(value) => <TagField color="blue" value={value} />}\n          />\n          <Table.Column\n            dataIndex="tax"\n            title="Tax(%)"\n            render={(value) => <TagField color="cyan" value={value} />}\n          />\n          <Table.Column dataIndex="custom_id" title="Custom Invoice ID" />\n\n          <Table.Column\n            dataIndex={["contact", "email"]}\n            title="Contact"\n            render={(value) => <EmailField value={value} />}\n          />\n          <Table.Column<IInvoice>\n            title="Actions"\n            dataIndex="actions"\n            render={(_, record) => {\n              return (\n                <Space>\n                  <EditButton hideText size="small" recordItemId={record?.id} />\n                  <DeleteButton\n                    hideText\n                    size="small"\n                    recordItemId={record?.id}\n                  />\n                </Space>\n              );\n            }}\n          />\n        </Table>\n      </List>\n    </>\n  );\n};\n')))),(0,i.yg)("p",null,"We already covered ",(0,i.yg)("inlineCode",{parentName:"p"},"useTable()")," in a couple of more components earlier, but in this instance pay attention to the ",(0,i.yg)("inlineCode",{parentName:"p"},"meta.populate")," property of the object passed to ",(0,i.yg)("inlineCode",{parentName:"p"},"useTable()")," hook. We can nest the ",(0,i.yg)("inlineCode",{parentName:"p"},"populate")," property in order to get deeply associated collections in our query results:"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-tsx"},'const { tableProps } = useTable<IInvoice>({\n  meta: {\n    populate: {\n      contact: { populate: ["client"] },\n      company: { populate: ["logo"] },\n      missions: "*",\n    },\n  },\n});\n')),(0,i.yg)("h3",{id:"refine-create-view-for-invoices"},"Refine ",(0,i.yg)("inlineCode",{parentName:"h3"},"create")," View for ",(0,i.yg)("inlineCode",{parentName:"h3"},"invoices")),(0,i.yg)("p",null,"The ",(0,i.yg)("inlineCode",{parentName:"p"},"<CreateInvoice />")," page for ",(0,i.yg)("inlineCode",{parentName:"p"},"invoices")," is accessible from the ",(0,i.yg)("inlineCode",{parentName:"p"},"<CreateButton />")," component that is placed inside the ",(0,i.yg)("strong",{parentName:"p"},"refine-Ant Design")," ",(0,i.yg)("inlineCode",{parentName:"p"},"<List />")," component by default."),(0,i.yg)("p",null,"The ",(0,i.yg)("inlineCode",{parentName:"p"},"<CreateInvoice />")," view looks like this:"),(0,i.yg)("details",null,(0,i.yg)("summary",null,"Show CreateInvoice code"),(0,i.yg)("p",null,(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-tsx",metastring:'title="src/pages/invoices/create.tsx"',title:'"src/pages/invoices/create.tsx"'},'import { Create, useForm, useSelect } from "@refinedev/antd";\nimport { Form, Input, Select, DatePicker } from "antd";\n\nimport { ICompany, IContact, IMission, IInvoice } from "interfaces";\n\nexport const CreateInvoice = () => {\n  const { formProps, saveButtonProps } = useForm<IInvoice>();\n\n  const { selectProps: companySelectProps } = useSelect<ICompany>({\n    resource: "companies",\n    optionLabel: "name",\n\n    pagination: {\n      mode: "server",\n    },\n  });\n\n  const { selectProps: contactSelectProps } = useSelect<IContact>({\n    resource: "contacts",\n    optionLabel: "first_name",\n\n    pagination: {\n      mode: "server",\n    },\n  });\n\n  const { selectProps: missionSelectProps } = useSelect<IMission>({\n    resource: "missions",\n    optionLabel: "mission",\n\n    pagination: {\n      mode: "server",\n    },\n  });\n\n  return (\n    <Create saveButtonProps={saveButtonProps}>\n      <Form {...formProps} layout="vertical" wrapperCol={{ md: 18, lg: 16 }}>\n        <Form.Item label="Invoice Name" name="name">\n          <Input />\n        </Form.Item>\n        <Form.Item\n          label="Company"\n          name="company"\n          rules={[\n            {\n              required: true,\n            },\n          ]}\n        >\n          <Select {...companySelectProps} />\n        </Form.Item>\n\n        <Form.Item\n          label="Missions"\n          name="missions"\n          rules={[\n            {\n              required: true,\n            },\n          ]}\n        >\n          <Select {...missionSelectProps} mode="multiple" />\n        </Form.Item>\n        <Form.Item label="Discount(%)" name="discount">\n          <Input />\n        </Form.Item>\n        <Form.Item label="Tax(%)" name="tax">\n          <Input />\n        </Form.Item>\n        <Form.Item label="Custom ID" name="custom_id">\n          <Input />\n        </Form.Item>\n        <Form.Item\n          label="Contact"\n          name="contact"\n          rules={[\n            {\n              required: true,\n            },\n          ]}\n        >\n          <Select {...contactSelectProps} />\n        </Form.Item>\n        <Form.Item label="Invoice Date" name="date">\n          <DatePicker style={{ width: "50%" }} />\n        </Form.Item>\n      </Form>\n    </Create>\n  );\n};\n')))),(0,i.yg)("p",null,"There are a couple of things important in the code above. First, the use of ",(0,i.yg)("inlineCode",{parentName:"p"},"<Create />")," component, which consumes the ",(0,i.yg)("inlineCode",{parentName:"p"},"saveButtonProps")," object extracted from the ",(0,i.yg)("inlineCode",{parentName:"p"},"useForm()")," hook. And secondly, the use of the ",(0,i.yg)("inlineCode",{parentName:"p"},"useSelect()")," hook. We'll come to ",(0,i.yg)("inlineCode",{parentName:"p"},"useSelect()")," in the next section about ",(0,i.yg)("inlineCode",{parentName:"p"},"edit")," view but notice that multiple ",(0,i.yg)("inlineCode",{parentName:"p"},"useSelect()")," hooks are used to fetch data from the ",(0,i.yg)("strong",{parentName:"p"},"Strapi")," backend, before they can be added to different fields of the form to create a new ",(0,i.yg)("inlineCode",{parentName:"p"},"invoices")," entry."),(0,i.yg)("p",null,(0,i.yg)("strong",{parentName:"p"},"Refine ",(0,i.yg)("inlineCode",{parentName:"strong"},"<Create />")," Component")),(0,i.yg)("p",null,"The ",(0,i.yg)("inlineCode",{parentName:"p"},"<Create />")," component by default places a ",(0,i.yg)("strong",{parentName:"p"},"refine-Ant Design")," ",(0,i.yg)("inlineCode",{parentName:"p"},"<SaveButton />")," component as its child and ",(0,i.yg)("inlineCode",{parentName:"p"},"saveButtonProps")," are passed to it. ",(0,i.yg)("inlineCode",{parentName:"p"},"saveButtonProps")," include props for the form action, button loading and disabling states. Here, when the ",(0,i.yg)("inlineCode",{parentName:"p"},"<SaveButton />")," is clicked ",(0,i.yg)("inlineCode",{parentName:"p"},"formProps.onFinish()")," is triggered, which eventually invokes the ",(0,i.yg)("inlineCode",{parentName:"p"},"dataProvider.create")," method via ",(0,i.yg)("inlineCode",{parentName:"p"},"useCreate()"),"."),(0,i.yg)("p",null,"For the details about how the ",(0,i.yg)("inlineCode",{parentName:"p"},"<SaveButton />")," works, feel free to read through the ",(0,i.yg)("a",{parentName:"p",href:"https://refine.dev/docs/api-reference/antd/components/buttons/save-button/"},"docs here"),"."),(0,i.yg)("h3",{id:"refine-edit-views-for-invoices"},"Refine ",(0,i.yg)("inlineCode",{parentName:"h3"},"edit")," Views for ",(0,i.yg)("inlineCode",{parentName:"h3"},"invoices")),(0,i.yg)("p",null,"The ",(0,i.yg)("inlineCode",{parentName:"p"},"<EditInvoice />")," page is more or less the same as the ",(0,i.yg)("inlineCode",{parentName:"p"},"create")," view. Its content looks as below:"),(0,i.yg)("details",null,(0,i.yg)("summary",null,"Show EditInvoice code"),(0,i.yg)("p",null,(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-tsx",metastring:'title="src/pages/invoices/edit.tsx"',title:'"src/pages/invoices/edit.tsx"'},'import { useForm, useSelect, Edit } from "@refinedev/antd";\nimport { Form, Input, Select } from "antd";\n\nimport { IInvoice } from "interfaces";\n\nexport const EditInvoice = () => {\n  const { formProps, saveButtonProps, queryResult } = useForm<IInvoice>({\n    meta: { populate: ["company", "contact", "missions"] },\n  });\n\n  const defaultValue = queryResult?.data?.data;\n\n  const { selectProps: companySelectProps } = useSelect({\n    resource: "companies",\n    defaultValue: defaultValue?.company.id,\n    optionLabel: "name",\n\n    pagination: {\n      mode: "server",\n    },\n  });\n\n  const { selectProps: contactSelectProps } = useSelect({\n    resource: "contacts",\n    defaultValue: defaultValue?.contact?.id,\n    optionLabel: "first_name",\n\n    pagination: {\n      mode: "server",\n    },\n  });\n\n  const { selectProps: missionSelectProps } = useSelect({\n    resource: "missions",\n    optionLabel: "mission",\n\n    pagination: {\n      mode: "server",\n    },\n  });\n\n  return (\n    <Edit saveButtonProps={saveButtonProps}>\n      <Form {...formProps} layout="vertical" wrapperCol={{ md: 18, lg: 16 }}>\n        <Form.Item label="Invoice Name" name="name">\n          <Input />\n        </Form.Item>\n        <Form.Item\n          label="Company"\n          name={["company", "id"]}\n          rules={[\n            {\n              required: true,\n            },\n          ]}\n        >\n          <Select {...companySelectProps} />\n        </Form.Item>\n\n        <Form.Item\n          label="Mission"\n          name={["missions"]}\n          rules={[\n            {\n              required: true,\n            },\n          ]}\n        >\n          <Select {...missionSelectProps} mode="multiple" />\n        </Form.Item>\n        <Form.Item label="Discount(%)" name="discount">\n          <Input />\n        </Form.Item>\n        <Form.Item label="Tax(%)" name="tax">\n          <Input />\n        </Form.Item>\n        <Form.Item label="Custom ID" name="custom_id">\n          <Input />\n        </Form.Item>\n        <Form.Item\n          label="Contact"\n          name={["contact", "id"]}\n          rules={[\n            {\n              required: true,\n            },\n          ]}\n        >\n          <Select {...contactSelectProps} />\n        </Form.Item>\n      </Form>\n    </Edit>\n  );\n};\n')))),(0,i.yg)("p",null,"This time, the ",(0,i.yg)("inlineCode",{parentName:"p"},"meta.populate")," property includes multiple associated resources in the query results."),(0,i.yg)("br",null),(0,i.yg)("p",null,(0,i.yg)("strong",{parentName:"p"},"Refine ",(0,i.yg)("inlineCode",{parentName:"strong"},"useSelect()")," Hook")),(0,i.yg)("p",null,"We are using multiple ",(0,i.yg)("inlineCode",{parentName:"p"},"useSelect()")," hooks that allow us fetch ",(0,i.yg)("inlineCode",{parentName:"p"},"companies"),", ",(0,i.yg)("inlineCode",{parentName:"p"},"missions")," and ",(0,i.yg)("inlineCode",{parentName:"p"},"contacts")," data and avail them to ",(0,i.yg)("inlineCode",{parentName:"p"},"<Form.Item />"),"s. Under the hood, a ",(0,i.yg)("inlineCode",{parentName:"p"},"useSelect()")," hook counts on the ",(0,i.yg)("inlineCode",{parentName:"p"},"useList()")," data hook to access and invoke the ",(0,i.yg)("inlineCode",{parentName:"p"},"dataProvider.getList")," method for fetching data from our ",(0,i.yg)("strong",{parentName:"p"},"Strapi")," backend. The argument object passed is, therefore, the same as that of ",(0,i.yg)("inlineCode",{parentName:"p"},"useList()"),". For more details, please see ",(0,i.yg)("a",{parentName:"p",href:"https://refine.dev/docs/api-reference/antd/hooks/field/useSelect/"},"the ",(0,i.yg)("inlineCode",{parentName:"a"},"useSelect()")," API reference here"),"."),(0,i.yg)("p",null,"With these components added, we should be able to create, list and edit invoices."),(0,i.yg)("img",{style:{alignSelf:"center"},src:"https://refine.ams3.cdn.digitaloceanspaces.com/blog/2023-04-13-refine-invoicer-4/useselect.png",alt:"react invoice generator"}),(0,i.yg)("br",null),(0,i.yg)("h2",{id:"low-level-inspection"},"Low Level Inspection"),(0,i.yg)("p",null,"We have used several high level ",(0,i.yg)("strong",{parentName:"p"},"refine-Ant Design")," hooks so far in this series. Namely, ",(0,i.yg)("inlineCode",{parentName:"p"},"useSimpleList()"),", ",(0,i.yg)("inlineCode",{parentName:"p"},"useModalForm()"),", ",(0,i.yg)("inlineCode",{parentName:"p"},"useDrawerForm()"),", ",(0,i.yg)("inlineCode",{parentName:"p"},"useTable()")," and ",(0,i.yg)("inlineCode",{parentName:"p"},"useSelect()"),". Their internal implementations are pretty sophisticated according to the specific requirements they fulfill, both in terms of data fetching and UI presentation."),(0,i.yg)("p",null,"In the following sections, we zoom in on the low level implementation of ",(0,i.yg)("inlineCode",{parentName:"p"},"useTable()"),", ",(0,i.yg)("inlineCode",{parentName:"p"},"useSelect()")," hooks and ",(0,i.yg)("inlineCode",{parentName:"p"},"<CreateButton />")," component. This is to shed some light into the tremendous tasks accomplished by ",(0,i.yg)("strong",{parentName:"p"},"Refine")," hooks and components behind the scenes. This should guide us enough to examine other hooks and components mentioned above. They are available inside the ",(0,i.yg)("inlineCode",{parentName:"p"},"node_modules/@refinedev/antd")," directory."),(0,i.yg)("h3",{id:"refine-ant-design-usetable-hook"},"refine-Ant Design ",(0,i.yg)("inlineCode",{parentName:"h3"},"useTable()")," Hook"),(0,i.yg)("p",null,"We mentioned that ",(0,i.yg)("inlineCode",{parentName:"p"},"useTable()")," is built on top of ",(0,i.yg)("inlineCode",{parentName:"p"},"useList()"),", which is indirectly true. This is because ",(0,i.yg)("strong",{parentName:"p"},"Refine"),"'s core module also has a ",(0,i.yg)("inlineCode",{parentName:"p"},"useTable()")," hook. We are using ",(0,i.yg)("strong",{parentName:"p"},"refine-Ant Design"),"'s ",(0,i.yg)("inlineCode",{parentName:"p"},"useTable()")," hook here, which is actually built on top of the core ",(0,i.yg)("inlineCode",{parentName:"p"},"useTable()")," hook."),(0,i.yg)("p",null,"Endowed a due patience, we can see this in action among many others in the ",(0,i.yg)("inlineCode",{parentName:"p"},"@refinedev/antd")," folder for ",(0,i.yg)("inlineCode",{parentName:"p"},"useTable()"),":"),(0,i.yg)("details",null,(0,i.yg)("summary",null,"Show useTable source code"),(0,i.yg)("p",null,(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-tsx",metastring:'title="node_modules/@refinedev/antd/src/hooks/table/useTable/useTable.ts"',title:'"node_modules/@refinedev/antd/src/hooks/table/useTable/useTable.ts"'},"const {\n  tableQuery,\n  current,\n  setCurrent,\n  pageSize,\n  setPageSize,\n  filters,\n  setFilters,\n  sorters,\n  setSorters,\n  sorter,\n  setSorter,\n  createLinkForSyncWithLocation,\n  pageCount,\n} = useTableCore<TData, TError>({\n  permanentSorter,\n  permanentFilter,\n  initialCurrent,\n  initialPageSize,\n  pagination,\n  hasPagination,\n  filters: filtersFromProp,\n  sorters: sortersFromProp,\n  initialSorter,\n  initialFilter,\n  syncWithLocation,\n  resource,\n  defaultSetFilterBehavior,\n  successNotification,\n  errorNotification,\n  queryOptions,\n  liveMode: liveModeFromProp,\n  onLiveEvent,\n  liveParams,\n  meta: pickNotDeprecated(meta, metaData),\n  metaData: pickNotDeprecated(meta, metaData),\n  dataProviderName,\n});\n")))),(0,i.yg)("p",null,"Then, it's the core ",(0,i.yg)("inlineCode",{parentName:"p"},"useTable()")," hook that is leveraging ",(0,i.yg)("inlineCode",{parentName:"p"},"useList()")," data hook in order to invoke the ",(0,i.yg)("inlineCode",{parentName:"p"},"dataProvider.getList")," method:"),(0,i.yg)("details",null,(0,i.yg)("summary",null,"Inside useTable hook"),(0,i.yg)("p",null,(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-tsx",metastring:'title="node_modules/@refinedev/core/src/hooks/useTable/index.ts"',title:'"node_modules/@refinedev/core/src/hooks/useTable/index.ts"'},"const queryResult = useList<TData, TError>({\n  resource: resourceInUse,\n  hasPagination,\n  pagination: { current, pageSize, mode: pagination?.mode },\n  filters: unionFilters(preferredPermanentFilters, filters),\n  sorters: unionSorters(preferredPermanentSorters, sorters),\n  queryOptions,\n  successNotification,\n  errorNotification,\n  meta: preferredMeta,\n  metaData: preferredMeta,\n  liveMode,\n  liveParams,\n  onLiveEvent,\n  dataProviderName,\n});\n")))),(0,i.yg)("p",null,"Then, among others inside the gigantic returned object, the ",(0,i.yg)("inlineCode",{parentName:"p"},"tableProps")," property conforms to the props that are accepted by the ",(0,i.yg)("a",{parentName:"p",href:"https://ant.design/components/table#table"},(0,i.yg)("strong",{parentName:"a"},"Ant Design")," ",(0,i.yg)("inlineCode",{parentName:"a"},"<Table />")," component"),":"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-tsx"},'return {\n  // ...\n  tableProps: {\n    dataSource: data?.data,\n    loading: liveMode === "auto" ? isLoading : !isFetched,\n    onChange,\n    pagination: antdPagination(),\n    scroll: { x: true },\n  },\n  // ...\n};\n')),(0,i.yg)("h3",{id:"refine-ant-design-useselect-hook"},"refine-Ant Design ",(0,i.yg)("inlineCode",{parentName:"h3"},"useSelect()")," Hook"),(0,i.yg)("p",null,"The ",(0,i.yg)("inlineCode",{parentName:"p"},"useList()")," hook is also being utilized ",(0,i.yg)("strong",{parentName:"p"},"for")," the ",(0,i.yg)("inlineCode",{parentName:"p"},"useSelect()")," ",(0,i.yg)("strong",{parentName:"p"},"refine-Ant Design")," hook, but inside the core ",(0,i.yg)("inlineCode",{parentName:"p"},"useSelect()")," hook which then plays its role inside the higher level ",(0,i.yg)("inlineCode",{parentName:"p"},"@refinedev/antd")," version."),(0,i.yg)("p",null,"The source code of ",(0,i.yg)("inlineCode",{parentName:"p"},"useSelect()")," inside ",(0,i.yg)("inlineCode",{parentName:"p"},"@refinedev/antd")," package uses ",(0,i.yg)("inlineCode",{parentName:"p"},"useSelectCore()")," in the following snippet:"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-tsx",metastring:'title="node_modules/@refinedev/antd/src/hooks/field/useSelect/index.ts"',title:'"node_modules/@refinedev/antd/src/hooks/field/useSelect/index.ts"'},"const { queryResult, defaultValueQueryResult, onSearch, options } =\n  useSelectCore(props);\n\nreturn {\n  selectProps: {\n    options,\n    onSearch,\n    loading: defaultValueQueryResult.isFetching,\n    showSearch: true,\n    filterOption: false,\n  },\n  queryResult,\n  defaultValueQueryResult,\n};\n")),(0,i.yg)("p",null,"Inside the core version, ",(0,i.yg)("inlineCode",{parentName:"p"},"useList()")," is key to fetching data from the backend API:"),(0,i.yg)("details",null,(0,i.yg)("summary",null,"Show useSelect source code"),(0,i.yg)("p",null,(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-tsx",metastring:'title="node_modules/@refinedev/core/src/hooks/useSelect/index.ts"',title:'"node_modules/@refinedev/core/src/hooks/useSelect/index.ts"'},"const queryResult = useList<TData, TError>({\n  resource,\n  sorters: pickNotDeprecated(sorters, sort),\n  filters: filters.concat(search),\n  pagination: {\n    current: pagination?.current,\n    pageSize: pagination?.pageSize ?? fetchSize,\n    mode: pagination?.mode,\n  },\n  hasPagination,\n  queryOptions: {\n    ...queryOptions,\n    onSuccess: (data) => {\n      defaultQueryOnSuccess(data);\n      queryOptions?.onSuccess?.(data);\n    },\n  },\n  successNotification,\n  errorNotification,\n  meta: pickNotDeprecated(meta, metaData),\n  metaData: pickNotDeprecated(meta, metaData),\n  liveMode,\n  liveParams,\n  onLiveEvent,\n  dataProviderName,\n});\n")))),(0,i.yg)("p",null,"The returned object is tailored to match ",(0,i.yg)("a",{parentName:"p",href:"https://ant.design/components/select#select-props"},"the props of the ",(0,i.yg)("strong",{parentName:"a"},"Ant Design")," ",(0,i.yg)("inlineCode",{parentName:"a"},"<Select />")," component"),":"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-tsx"},"return {\n  selectProps: {\n    options,\n    onSearch,\n    loading: defaultValueQueryResult.isFetching,\n    showSearch: true,\n    filterOption: false,\n  },\n  queryResult,\n  defaultValueQueryResult,\n};\n")),(0,i.yg)("h3",{id:"refine-ant-design-deletebutton-"},"refine-Ant Design ",(0,i.yg)("inlineCode",{parentName:"h3"},"<DeleteButton />")),(0,i.yg)("p",null,"The ",(0,i.yg)("inlineCode",{parentName:"p"},"<DeleteButton />")," implements ",(0,i.yg)("inlineCode",{parentName:"p"},"useDelete")," directly. In ",(0,i.yg)("inlineCode",{parentName:"p"},"@refinedev/antd")," ",(0,i.yg)("inlineCode",{parentName:"p"},"v5.1.2"),", it is invoked like so:"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-tsx",metastring:'title="node_modules/@refinedev/antd/src/components/buttons/delete/index.tsx"',title:'"node_modules/@refinedev/antd/src/components/buttons/delete/index.tsx"'},"const { mutate, isLoading, variables } = useDelete();\n")),(0,i.yg)("p",null,"And the returned JSX has a ",(0,i.yg)("inlineCode",{parentName:"p"},"<Popconfirm />")," component with an ",(0,i.yg)("inlineCode",{parentName:"p"},"onConfirm")," prop. The delete ",(0,i.yg)("inlineCode",{parentName:"p"},"mutate")," function is passed to ",(0,i.yg)("inlineCode",{parentName:"p"},"onConfirm")," prop, which basically means to invoke ",(0,i.yg)("inlineCode",{parentName:"p"},"dataProvider.delete")," upon confirmation of a delete pop up:"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-tsx"},'return (\n    <Popconfirm\n        // ...\n        onConfirm={(): void => {\n            if ((recordItemId ?? id) && resource?.name) {\n                mutate(\n                    {\n                        id: recordItemId ?? id ?? "",\n                        resource: resource?.name,\n                        mutationMode,\n                        successNotification,\n                        errorNotification,\n                        meta: pickNotDeprecated(meta, metaData),\n                        metaData: pickNotDeprecated(meta, metaData),\n                        dataProviderName,\n                        invalidates,\n                    },\n                    {\n                        onSuccess: (value) => {\n                            onSuccess && onSuccess(value);\n                        },\n                    },\n                );\n            }\n        }}\n        // ...\n    </Popconfirm>\n);\n')),(0,i.yg)("p",null,"As we can see from the above analysis, in the background, ",(0,i.yg)("strong",{parentName:"p"},"Refine")," handles a lot of data heavy tasks, fine-tunes compatibility with popular stable UI components; and in the foreground, it keeps its hooks and elements highly customizable, compact and elegant."),(0,i.yg)("h2",{id:"summary"},"Summary"),(0,i.yg)("p",null,"In this post, we added CRUD pages for ",(0,i.yg)("inlineCode",{parentName:"p"},"missions")," and ",(0,i.yg)("inlineCode",{parentName:"p"},"invoices")," pages in our ",(0,i.yg)("strong",{parentName:"p"},"Pdf Invoice Generator")," app."),(0,i.yg)("p",null,"We set off with creating ",(0,i.yg)("strong",{parentName:"p"},"Strapi")," collections for these resources and setting permissions for ",(0,i.yg)("inlineCode",{parentName:"p"},"authenticated")," users to access them. We then added the resource objects and route definitions before we built the pages and their partial components."),(0,i.yg)("p",null,"We discussed in significant depth how higher level hooks like ",(0,i.yg)("inlineCode",{parentName:"p"},"useTable()")," and ",(0,i.yg)("inlineCode",{parentName:"p"},"useModalForm()")," provide developer convenience by dealing with data fetching and processing behind the scenes. We then inspect the source code of a couple of these hooks and the ",(0,i.yg)("inlineCode",{parentName:"p"},"<DeleteButton />")," to see how the heavy tasks are done."),(0,i.yg)("p",null,"In the next episode, we add PDF renderer to our app. The PDF renderer will allow users to generate and voew a pdf document for an invoice."))}g.isMDXComponent=!0}}]);